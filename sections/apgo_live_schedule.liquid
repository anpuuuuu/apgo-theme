{% comment %}
  APGO ç›´æ’­æ™‚ç¨‹è¡¨ Section - å„ªåŒ–é‡æ§‹ç‰ˆ
  æª”æ¡ˆä½ç½®: sections/apgo-live-schedule-optimized.liquid
  å‘½åè¦ç¯„: ç›´æ’­æ™‚ç¨‹é -[å€å¡Šåç¨±]
  
  ä¸»è¦æ”¹é€²ï¼š
  1. ç§»é™¤ overflow-y ç›¸é—œè¨­å®šï¼Œæ”¹ç”¨ overflow: hidden
  2. å›ºå®šå®¹å™¨é«˜åº¦ï¼Œé¿å…å‹•æ…‹è¨ˆç®—
  3. ç°¡åŒ–è§¸æ§äº‹ä»¶è™•ç†
  4. å„ªåŒ– CSS å±¤ç´šçµæ§‹
  5. ä½¿ç”¨ transform æ›¿ä»£ scroll å¯¦ç¾æ»‘å‹•
{% endcomment %}

<section class="apgo-live-schedule-section" data-section-id="{{ section.id }}">
  <style>
    #shopify-section-{{ section.id }} {
      --primary-orange: {{ section.settings.primary_color }};
      --primary-orange-light: {{ section.settings.primary_color_light }};
      --text-white: {{ section.settings.text_white }};
      --text-gray: {{ section.settings.text_gray }};
      --text-light-gray: {{ section.settings.text_light_gray }};
      --dark-bg: {{ section.settings.dark_bg }};
      --card-bg: {{ section.settings.card_bg }};
      --card-hover: {{ section.settings.card_hover }};
      --border-color: {{ section.settings.border_color }};
      --card-width: {{ section.settings.card_width }}px;
      --card-gap: {{ section.settings.card_gap }}px;
      --card-padding: {{ section.settings.card_padding }}px;
      --border-radius: {{ section.settings.border_radius }}px;
      --animation-speed: {{ section.settings.animation_speed }}s;
    }

    #shopify-section-{{ section.id }} * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    #shopify-section-{{ section.id }} .apgo-live-schedule-section {
      font-family: {{ section.settings.font_family }};
      background: var(--dark-bg);
      color: var(--text-white);
      min-height: 100vh;
      position: relative;
      overflow-x: hidden;
      overflow-y: visible; /* å…è¨±å¡ç‰‡ hover è¶…å‡ºå®¹å™¨é¡¯ç¤º */
    }

    #shopify-section-{{ section.id }} {
      overflow: visible; /* ç¢ºä¿æœ€å¤–å±¤ section ä¸è£åˆ‡å¡ç‰‡ */
    }

    /* èƒŒæ™¯è£é£¾ */
    {% if section.settings.show_bg_decoration %}
    #shopify-section-{{ section.id }} .bg-decoration {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 0;
      pointer-events: none;
      overflow: hidden;
    }

    #shopify-section-{{ section.id }} .bg-decoration::before {
      content: '';
      position: absolute;
      top: -50%;
      right: -20%;
      width: 800px;
      height: 800px;
      background: radial-gradient(circle, rgba(240, 132, 24, {{ section.settings.bg_decoration_opacity | divided_by: 100.0 }}) 0%, transparent 70%);
      animation: float {{ section.settings.bg_animation_duration }}s ease-in-out infinite;
    }

    #shopify-section-{{ section.id }} .bg-decoration::after {
      content: '';
      position: absolute;
      bottom: -30%;
      left: -10%;
      width: 600px;
      height: 600px;
      background: radial-gradient(circle, rgba(240, 132, 24, {{ section.settings.bg_decoration_opacity | divided_by: 100.0 | times: 0.67 }}) 0%, transparent 70%);
      animation: float {{ section.settings.bg_animation_duration | times: 0.83 }}s ease-in-out infinite reverse;
    }

    @keyframes float {
      0%, 100% { transform: translate(0, 0) rotate(0deg); }
      50% { transform: translate(30px, -20px) rotate(180deg); }
    }
    {% endif %}

    /* ä¸»å®¹å™¨ */
    #shopify-section-{{ section.id }} .container {
      max-width: {{ section.settings.container_width }}px;
      margin: 0 auto;
      padding: {{ section.settings.section_padding_top }}px {{ section.settings.section_padding_horizontal }}px {{ section.settings.section_padding_bottom }}px;
      position: relative;
      z-index: 1;
      overflow: visible; /* ç¢ºä¿å¡ç‰‡ hover ä¸è¢«è£åˆ‡ */
    }

    /* æ¨™é¡Œå€ */
    #shopify-section-{{ section.id }} .header-section {
      text-align: {{ section.settings.header_alignment }};
      margin-bottom: {{ section.settings.header_margin_bottom }}px;
    }

    #shopify-section-{{ section.id }} .main-title {
    #shopify-section-{{ section.id }} .team-dynamic-title {
      font-size: 1.5rem;
      font-weight: 300;
      margin-left: 12px;
      color: var(--primary-orange);
      display: inline-block;
      vertical-align: middle;
    }
      font-size: {{ section.settings.title_font_size_desktop }}rem;
      font-weight: {{ section.settings.title_font_weight }};
      letter-spacing: {{ section.settings.title_letter_spacing }}px;
      margin-bottom: 20px;
      {% if section.settings.title_gradient %}
      background: linear-gradient(135deg, var(--text-white) 0%, var(--primary-orange) 100%);
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      {% else %}
      color: var(--text-white);
      {% endif %}
      position: relative;
      display: inline-block;
    }

    {% if section.settings.show_title_badge %}
    #shopify-section-{{ section.id }} .main-title::after {
      content: '{{ section.settings.title_badge_text }}';
      position: absolute;
      top: -15px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 0.8rem;
      letter-spacing: 5px;
      color: var(--primary-orange);
      opacity: 0.5;
      font-weight: 400;
    }
    {% endif %}

    #shopify-section-{{ section.id }} .subtitle {
      font-size: {{ section.settings.subtitle_font_size }}rem;
      color: var(--text-gray);
      font-weight: 300;
      letter-spacing: 1px;
      opacity: 0.8;
    }

    /* åˆ†é æ¨™ç±¤ */
    #shopify-section-{{ section.id }} .tab-navigation {
      display: flex;
      justify-content: center;
      margin-bottom: {{ section.settings.tab_margin_bottom }}px;
      gap: 5px;
      background: var(--card-bg);
      padding: 8px;
      border-radius: 50px;
      max-width: 400px;
      margin-left: auto;
      margin-right: auto;
    }

    #shopify-section-{{ section.id }} .tab-btn {
      flex: 1;
      padding: {{ section.settings.tab_padding_vertical }}px {{ section.settings.tab_padding_horizontal }}px;
      background: transparent;
      border: none;
      color: var(--text-gray);
      cursor: pointer;
      border-radius: 40px;
      font-size: 1rem;
      font-weight: 500;
      letter-spacing: 0.5px;
      transition: all var(--animation-speed) cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
    }

    #shopify-section-{{ section.id }} .tab-btn.active {
      background: linear-gradient(135deg, var(--primary-orange) 0%, var(--primary-orange-light) 100%);
      color: var(--text-white);
      box-shadow: 0 8px 25px rgba(240, 132, 24, 0.3);
    }

    #shopify-section-{{ section.id }} .tab-btn:not(.active):hover {
      color: var(--text-white);
      background: rgba(240, 132, 24, 0.1);
    }

    /* æ™‚ç¨‹å…§å®¹å€ */
    #shopify-section-{{ section.id }} .schedule-content {
      display: none;
      animation: fadeInUp 0.6s ease;
    }

    #shopify-section-{{ section.id }} .schedule-content.active {
      display: block;
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }


    /* é‡æ–°è¨­è¨ˆçš„æ»‘å‹•å®¹å™¨ */
    #shopify-section-{{ section.id }} .carousel-wrapper {
      position: relative;
      width: 100%;
      margin-bottom: 40px;
      padding: 80px 0 40px 0; /* å†åŠ å¤§ä¸Šæ–¹ paddingï¼Œé¿å… hover ä¸Šç§»è¢«è£åˆ‡ */
      overflow-x: hidden;
      overflow-y: visible;
    }

    #shopify-section-{{ section.id }} .carousel-viewport {
      position: relative;
      width: 100%;
      overflow-x: auto;
      overflow-y: visible; /* å…è¨±å¡ç‰‡ hover/é»æ“Šä¸Šç§»é¡¯ç¤º */
      scroll-behavior: smooth;
      -webkit-overflow-scrolling: touch;
      touch-action: pan-x; /* åªå…è¨±æ°´å¹³è§¸æ§ */
    }

    #shopify-section-{{ section.id }} .carousel-track {
      display: flex;
      align-items: stretch;
      transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
      will-change: transform;
    }

    /* æ—¥æœŸå¡ç‰‡ - ç°¡åŒ–ç‰ˆ */
    #shopify-section-{{ section.id }} .day-card {
      flex: 0 0 var(--card-width);
      margin-right: var(--card-gap);
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: var(--border-radius);
      padding: var(--card-padding);
      transition: all var(--animation-speed) cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      cursor: pointer;
      user-select: none;
      -webkit-user-select: none;
      display: flex;
      flex-direction: column;
      height: 100%;
    }

    #shopify-section-{{ section.id }} .day-card:last-child {
      margin-right: 0;
    }

    /* ä»Šæ—¥å¡ç‰‡ç‰¹æ®Šæ¨£å¼ */
    #shopify-section-{{ section.id }} .day-card.today {
      border-color: var(--primary-orange);
      background: linear-gradient(135deg, var(--card-bg) 0%, rgba(240, 132, 24, 0.05) 100%);
    }

    #shopify-section-{{ section.id }} .day-card.today .day-status {
      background: rgba(240, 132, 24, 0.2);
      border-color: var(--primary-orange);
    }

    #shopify-section-{{ section.id }} .day-card.today .today-badge {
      display: inline-block;
      color: var(--primary-orange);
      font-size: 0.8rem;
      margin-left: 8px;
    }


    #shopify-section-{{ section.id }} .day-card:hover {
      background: var(--card-hover);
      border-color: var(--primary-orange);
      box-shadow: 0 20px 40px rgba(240, 132, 24, {{ section.settings.card_hover_shadow_opacity | divided_by: 100.0 }});
    }

    #shopify-section-{{ section.id }} .day-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
      padding-bottom: 15px;
      border-bottom: 1px solid var(--border-color);
    }

    #shopify-section-{{ section.id }} .day-name {
      font-size: 1.4rem;
      font-weight: 600;
      color: var(--text-white);
      letter-spacing: 0.5px;
      display: flex;
      align-items: center;
    }

    #shopify-section-{{ section.id }} .day-status {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 5px 12px;
      background: rgba(240, 132, 24, 0.1);
      border: 1px solid rgba(240, 132, 24, 0.3);
      border-radius: 20px;
      font-size: 0.85rem;
      color: var(--primary-orange);
      flex-shrink: 0;
    }

    #shopify-section-{{ section.id }} .status-dot {
      width: 6px;
      height: 6px;
      background: var(--primary-orange);
      border-radius: 50%;
      animation: pulse 2s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    /* æ™‚æ®µåˆ—è¡¨ - å›ºå®šé«˜åº¦ */
    #shopify-section-{{ section.id }} .time-slots {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: {{ section.settings.slot_gap }}px;
      min-height: 200px;
      justify-content: flex-start;
    }

    #shopify-section-{{ section.id }} .time-slot {
      padding: {{ section.settings.slot_padding }}px;
      background: rgba(255, 255, 255, 0.02);
      border: 1px solid rgba(255, 255, 255, 0.05);
      border-radius: 12px;
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    #shopify-section-{{ section.id }} .time-slot::after {
      content: '';
      position: absolute;
      top: 50%;
      left: -100%;
      width: 100%;
      height: 1px;
      background: linear-gradient(90deg, transparent, var(--primary-orange), transparent);
      transform: translateY(-50%);
      transition: left 0.8s ease;
    }

    #shopify-section-{{ section.id }} .time-slot:hover::after {
      left: 100%;
    }

    #shopify-section-{{ section.id }} .time-slot:hover {
      background: rgba(240, 132, 24, 0.05);
      border-color: rgba(240, 132, 24, 0.2);
      transform: translateX(5px);
    }

    #shopify-section-{{ section.id }} .slot-time {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--primary-orange);
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    {% if section.settings.show_time_icon %}
    #shopify-section-{{ section.id }} .slot-time::before {
      content: '{{ section.settings.time_icon }}';
      font-size: 1rem;
    }
    {% endif %}

    #shopify-section-{{ section.id }} .slot-platform {
      font-size: 0.95rem;
      color: var(--text-gray);
      font-weight: 300;
      {% if section.settings.show_time_icon %}
      padding-left: 26px;
      {% endif %}
    }

    /* å°èˆªæŒ‰éˆ• - æ–°è¨­è¨ˆ */
    #shopify-section-{{ section.id }} .carousel-nav {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      width: 100%;
      pointer-events: none;
      z-index: 2;
    }

    #shopify-section-{{ section.id }} .carousel-btn {
      position: absolute;
      width: 48px;
      height: 48px;
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: 50%;
      color: var(--text-white);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      pointer-events: all;
      transition: all 0.3s ease;
      opacity: 0;
      font-size: 20px;
    }

    #shopify-section-{{ section.id }} .carousel-wrapper:hover .carousel-btn {
      opacity: 1;
    }

    #shopify-section-{{ section.id }} .carousel-btn:hover {
      background: var(--primary-orange);
      border-color: var(--primary-orange);
      transform: scale(1.1);
    }

    #shopify-section-{{ section.id }} .carousel-btn.prev {
      left: -60px;
    }

    #shopify-section-{{ section.id }} .carousel-btn.next {
      right: -60px;
    }

    #shopify-section-{{ section.id }} .carousel-btn:disabled {
      opacity: 0.3;
      cursor: not-allowed;
    }

    /* å¼•å°é»æ¨£å¼ */
    #shopify-section-{{ section.id }} .carousel-dots {
      display: flex;
      justify-content: center;
      gap: 8px;
      margin-top: 20px;
    }
    
    #shopify-section-{{ section.id }} .carousel-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: rgba(255,255,255,.25);
      border: 1px solid rgba(255,255,255,.35);
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    #shopify-section-{{ section.id }} .carousel-dot.active {
      background: var(--primary-orange);
      transform: scale(1.2);
      box-shadow: 0 0 0 4px rgba(240,132,24,.15);
    }

    /* ç„¡ç›´æ’­æç¤º */
    #shopify-section-{{ section.id }} .no-stream {
      text-align: center;
      padding: 40px;
      color: var(--text-gray);
      font-size: 1rem;
      opacity: 0.7;
    }

    /* éŸ¿æ‡‰å¼è¨­è¨ˆ */
    @media (max-width: 1200px) {
      #shopify-section-{{ section.id }} .carousel-btn.prev {
        left: 10px;
      }
      #shopify-section-{{ section.id }} .carousel-btn.next {
        right: 10px;
      }
    }

    @media (max-width: 768px) {
      #shopify-section-{{ section.id }} {
        --card-width: {{ section.settings.card_width | times: 0.875 }}px;
      }
      
      #shopify-section-{{ section.id }} .container {
        padding: {{ section.settings.section_padding_top | times: 0.67 }}px {{ section.settings.section_padding_horizontal | times: 0.75 }}px {{ section.settings.section_padding_bottom | times: 0.67 }}px;
      }

      #shopify-section-{{ section.id }} .main-title {
        font-size: {{ section.settings.title_font_size_mobile }}rem;
      }

      #shopify-section-{{ section.id }} .day-card {
        padding: {{ section.settings.card_padding | times: 0.71 }}px;
      }

      #shopify-section-{{ section.id }} .carousel-btn {
        display: none;
      }
    }

    @media (max-width: 480px) {
      #shopify-section-{{ section.id }} {
        --card-width: {{ section.settings.card_width_mobile }}px;
      }
      
      #shopify-section-{{ section.id }} .main-title {
        font-size: {{ section.settings.title_font_size_mobile | times: 0.8 }}rem;
      }

      #shopify-section-{{ section.id }} .tab-navigation {
        gap: 3px;
        padding: 5px;
      }

      #shopify-section-{{ section.id }} .tab-btn {
        padding: 12px 20px;
        font-size: 0.9rem;
      }

      #shopify-section-{{ section.id }} .day-card {
        padding: {{ section.settings.card_padding | times: 0.57 }}px;
      }
    }
  </style>

  <!-- èƒŒæ™¯è£é£¾ -->
  {% if section.settings.show_bg_decoration %}
  <div class="bg-decoration"></div>
  {% endif %}

  <!-- ä¸»å®¹å™¨ -->
  <div class="container">
    <!-- æ¨™é¡Œå€ -->
    {% if section.settings.show_header %}
    <div class="header-section">
      <h1 class="main-title">
        <span class="team-dynamic-title">{{ section.settings.taiwan_team_title }}</span>
        {{ section.settings.main_title }}
      </h1>
      {% if section.settings.subtitle != blank %}
      <p class="subtitle">{{ section.settings.subtitle }}</p>
      {% endif %}
    </div>
    {% endif %}

    <!-- å°ç£åœ˜éšŠæ™‚ç¨‹ -->
    <div id="taiwan-{{ section.id }}" class="schedule-content active" data-team="taiwan">
      <div class="tab-navigation">
        <button class="tab-btn active" data-tab="taiwan">{{ section.settings.taiwan_tab_text }}</button>
        <button class="tab-btn" data-tab="singapore">{{ section.settings.singapore_tab_text }}</button>
      </div>
      <div class="carousel-wrapper">
        <div class="carousel-viewport" id="taiwan-carousel-{{ section.id }}">
          <div class="carousel-track">
            {% for day in section.blocks %}
              {% if day.settings.team == 'taiwan' %}
                <div class="day-card" data-day="{{ day.settings.day_name }}" data-index="{{ forloop.index0 }}">
                  <div class="day-header">
                    <span class="day-name">
                      {{ day.settings.day_name }}
                      <span class="today-badge" style="display: none;">(ä»Šæ—¥)</span>
                    </span>
                    {% if day.settings.has_stream %}
                    <span class="day-status">
                      <span class="status-dot"></span>
                      {{ day.settings.status_text | default: 'ç›´æ’­æ—¥' }}
                    </span>
                    {% endif %}
                  </div>
                  <div class="time-slots">
                    {% if day.settings.has_stream %}
                      {% if day.settings.slot1_time != blank %}
                      <div class="time-slot">
                        <div class="slot-time">{{ day.settings.slot1_time }}</div>
                        <div class="slot-platform">{{ day.settings.slot1_platform }}</div>
                      </div>
                      {% endif %}
                      
                      {% if day.settings.slot2_time != blank %}
                      <div class="time-slot">
                        <div class="slot-time">{{ day.settings.slot2_time }}</div>
                        <div class="slot-platform">{{ day.settings.slot2_platform }}</div>
                      </div>
                      {% endif %}
                      
                      {% if day.settings.slot3_time != blank %}
                      <div class="time-slot">
                        <div class="slot-time">{{ day.settings.slot3_time }}</div>
                        <div class="slot-platform">{{ day.settings.slot3_platform }}</div>
                      </div>
                      {% endif %}
                    {% else %}
                      <div class="no-stream">{{ day.settings.no_stream_text | default: 'æœ¬æ—¥ç„¡ç›´æ’­å®‰æ’' }}</div>
                    {% endif %}
                  </div>
                </div>
              {% endif %}
            {% endfor %}
          </div>
        </div>
        <div class="carousel-nav">
          <button class="carousel-btn prev" data-carousel="taiwan-carousel-{{ section.id }}">â€¹</button>
          <button class="carousel-btn next" data-carousel="taiwan-carousel-{{ section.id }}">â€º</button>
        </div>
        <div class="carousel-dots" data-dots-for="taiwan-carousel-{{ section.id }}"></div>
      </div>
    </div>

    <!-- æ–°é¦¬åœ˜éšŠæ™‚ç¨‹ -->
    <div id="singapore-{{ section.id }}" class="schedule-content" data-team="singapore">
      <div class="tab-navigation">
        <button class="tab-btn" data-tab="taiwan">{{ section.settings.taiwan_tab_text }}</button>
        <button class="tab-btn active" data-tab="singapore">{{ section.settings.singapore_tab_text }}</button>
      </div>
      <div class="carousel-wrapper">
        <div class="carousel-viewport" id="singapore-carousel-{{ section.id }}">
          <div class="carousel-track">
            {% for day in section.blocks %}
              {% if day.settings.team == 'singapore' %}
                <div class="day-card" data-day="{{ day.settings.day_name }}" data-index="{{ forloop.index0 }}">
                  <div class="day-header">
                    <span class="day-name">
                      {{ day.settings.day_name }}
                      <span class="today-badge" style="display: none;">(ä»Šæ—¥)</span>
                    </span>
                    {% if day.settings.has_stream %}
                    <span class="day-status">
                      <span class="status-dot"></span>
                      {{ day.settings.status_text | default: 'ç›´æ’­æ—¥' }}
                    </span>
                    {% endif %}
                  </div>
                  <div class="time-slots">
                    {% if day.settings.has_stream %}
                      {% if day.settings.slot1_time != blank %}
                      <div class="time-slot">
                        <div class="slot-time">{{ day.settings.slot1_time }}</div>
                        <div class="slot-platform">{{ day.settings.slot1_platform }}</div>
                      </div>
                      {% endif %}
                      
                      {% if day.settings.slot2_time != blank %}
                      <div class="time-slot">
                        <div class="slot-time">{{ day.settings.slot2_time }}</div>
                        <div class="slot-platform">{{ day.settings.slot2_platform }}</div>
                      </div>
                      {% endif %}
                      
                      {% if day.settings.slot3_time != blank %}
                      <div class="time-slot">
                        <div class="slot-time">{{ day.settings.slot3_time }}</div>
                        <div class="slot-platform">{{ day.settings.slot3_platform }}</div>
                      </div>
                      {% endif %}
                    {% else %}
                      <div class="no-stream">{{ day.settings.no_stream_text | default: 'æœ¬æ—¥ç„¡ç›´æ’­å®‰æ’' }}</div>
                    {% endif %}
                  </div>
                </div>
              {% endif %}
            {% endfor %}
          </div>
        </div>
        <div class="carousel-nav">
          <button class="carousel-btn prev" data-carousel="singapore-carousel-{{ section.id }}">â€¹</button>
          <button class="carousel-btn next" data-carousel="singapore-carousel-{{ section.id }}">â€º</button>
        </div>
        <div class="carousel-dots" data-dots-for="singapore-carousel-{{ section.id }}"></div>
      </div>
    </div>
  </div>

  <script>
    (function() {
      const sectionId = '{{ section.id }}';
      const section = document.querySelector(`#shopify-section-${sectionId}`);
      
      class CarouselManager {
        constructor(carouselId) {
          this.viewport = section.querySelector(`#${carouselId}`);
          this.track = this.viewport.querySelector('.carousel-track');
          this.cards = this.track.querySelectorAll('.day-card');
          this.hasCenteredToday = false;
          this.init();
        }

        centerCard(card) {
          const targetCenter = card.offsetLeft + card.offsetWidth / 2;
          const screenCenter = window.innerWidth / 2;
          const scrollLeft = targetCenter - screenCenter;
          this.viewport.scrollTo({
            left: scrollLeft,
            behavior: 'smooth'
          });
        }

        init() {
          this.markToday();
          this.cards.forEach(card => {
            card.addEventListener('click', () => {
              this.centerCard(card);
            });
          });
        }

        markToday() {
          const today = new Date().getDay();
          const dayNames = ['é€±æ—¥', 'é€±ä¸€', 'é€±äºŒ', 'é€±ä¸‰', 'é€±å››', 'é€±äº”', 'é€±å…­'];
          const todayName = dayNames[today];

          this.cards.forEach((card, index) => {
            const badge = card.querySelector('.today-badge');
            if (card.dataset.day === todayName) {
              card.classList.add('today');
              if (badge) badge.style.display = 'inline-block';
              // åš´æ ¼ç½®ä¸­ä»Šæ—¥å¡ç‰‡ï¼Œåªåœ¨å°šæœªç½®ä¸­æ™‚åŸ·è¡Œ
              if (!this.hasCenteredToday) {
                this.centerCard(card);
                this.hasCenteredToday = true;
              }
            } else {
              card.classList.remove('today');
              if (badge) badge.style.display = 'none';
            }
          });
        }
      }
      
      // åˆå§‹åŒ–æ‰€æœ‰è¼ªæ’­
      const taiwanCarousel = new CarouselManager(`taiwan-carousel-${sectionId}`);
      const singaporeCarousel = new CarouselManager(`singapore-carousel-${sectionId}`);
      
      // åˆ†é åˆ‡æ›
      const tabBtns = section.querySelectorAll('.tab-btn');
      const dynamicTitle = section.querySelector('.team-dynamic-title');
      tabBtns.forEach(btn => {
        btn.addEventListener('click', function() {
          const targetTab = this.dataset.tab;
          // æ¸…é™¤æ‰€æœ‰æŒ‰éˆ•çš„ active ç‹€æ…‹
          tabBtns.forEach(b => b.classList.remove('active'));
          // è®“æ‰€æœ‰å°æ‡‰ targetTab çš„æŒ‰éˆ•äº®ç‡ˆ
          section.querySelectorAll(`.tab-btn[data-tab="${targetTab}"]`).forEach(b => {
            b.classList.add('active');
          });
          // æ›´æ–°å…§å®¹é¡¯ç¤º
          section.querySelectorAll('.schedule-content').forEach(content => {
            content.classList.remove('active');
          });
          const targetContent = section.querySelector(`#${targetTab}-${sectionId}`);
          if (targetContent) {
            targetContent.classList.add('active');
          }
          // åˆ‡æ›åœ˜éšŠæ¨™é¡Œæ–‡å­—
          if (dynamicTitle) {
            if (targetTab === 'taiwan') {
              dynamicTitle.textContent = '{{ section.settings.taiwan_team_title }}';
            } else {
              dynamicTitle.textContent = '{{ section.settings.singapore_team_title }}';
            }
          }
        });
      });
    })();
  </script>
</section>

{% schema %}
{
  "name": "APGO ç›´æ’­æ™‚ç¨‹è¡¨",
  "tag": "section",
  "class": "apgo-live-schedule",
  "settings": [
    {
      "type": "header",
      "content": "ğŸ¨ é¡è‰²è¨­å®š"
    },
    {
      "type": "color",
      "id": "primary_color",
      "label": "ä¸»è¦é¡è‰²",
      "default": "#f08418"
    },
    {
      "type": "color",
      "id": "primary_color_light",
      "label": "ä¸»è¦é¡è‰² (æ·º)",
      "default": "#ff9a3c"
    },
    {
      "type": "color",
      "id": "text_white",
      "label": "ç™½è‰²æ–‡å­—",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "text_gray",
      "label": "ç°è‰²æ–‡å­—",
      "default": "#cccccc"
    },
    {
      "type": "color",
      "id": "text_light_gray",
      "label": "æ·ºç°è‰²æ–‡å­—",
      "default": "#999999"
    },
    {
      "type": "color",
      "id": "dark_bg",
      "label": "æ·±è‰²èƒŒæ™¯",
      "default": "#0a0a0a"
    },
    {
      "type": "color",
      "id": "card_bg",
      "label": "å¡ç‰‡èƒŒæ™¯",
      "default": "#1a1a1a"
    },
    {
      "type": "color",
      "id": "card_hover",
      "label": "å¡ç‰‡æ‡¸åœèƒŒæ™¯",
      "default": "#242424"
    },
    {
      "type": "color",
      "id": "border_color",
      "label": "é‚Šæ¡†é¡è‰²",
      "default": "rgba(255, 255, 255, 0.1)"
    },
    {
      "type": "header",
      "content": "ğŸ“ ç‰ˆé¢è¨­å®š"
    },
    {
      "type": "range",
      "id": "container_width",
      "label": "å®¹å™¨æœ€å¤§å¯¬åº¦",
      "min": 1000,
      "max": 1600,
      "step": 100,
      "default": 1400,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "section_padding_top",
      "label": "å€å¡Šä¸Šé–“è·",
      "min": 20,
      "max": 120,
      "step": 10,
      "default": 60,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "section_padding_bottom",
      "label": "å€å¡Šä¸‹é–“è·",
      "min": 20,
      "max": 120,
      "step": 10,
      "default": 60,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "section_padding_horizontal",
      "label": "å€å¡Šæ°´å¹³é–“è·",
      "min": 10,
      "max": 60,
      "step": 5,
      "default": 20,
      "unit": "px"
    },
    {
      "type": "header",
      "content": "ğŸ“ æ¨™é¡Œè¨­å®š"
    },
    {
      "type": "checkbox",
      "id": "show_header",
      "label": "é¡¯ç¤ºæ¨™é¡Œå€",
      "default": true
    },
    {
      "type": "text",
      "id": "main_title",
      "label": "ä¸»æ¨™é¡Œ",
      "default": "APGO ç›´æ’­æ™‚ç¨‹"
    },
    {
      "type": "text",
      "id": "subtitle",
      "label": "å‰¯æ¨™é¡Œ",
      "default": "èˆ‡å°ˆæ¥­åœ˜éšŠå³æ™‚äº’å‹• Â· æŒæ¡ç¬¬ä¸€æ‰‹ç”¢å“è³‡è¨Š"
    },
    {
      "type": "select",
      "id": "header_alignment",
      "label": "æ¨™é¡Œå°é½Š",
      "options": [
        { "value": "left", "label": "é å·¦" },
        { "value": "center", "label": "ç½®ä¸­" },
        { "value": "right", "label": "é å³" }
      ],
      "default": "center"
    },
    {
      "type": "range",
      "id": "title_font_size_desktop",
      "label": "æ¨™é¡Œæ–‡å­—å¤§å° (æ¡Œé¢)",
      "min": 2,
      "max": 5,
      "step": 0.5,
      "default": 3.5,
      "unit": "rem"
    },
    {
      "type": "range",
      "id": "title_font_size_mobile",
      "label": "æ¨™é¡Œæ–‡å­—å¤§å° (æ‰‹æ©Ÿ)",
      "min": 1.5,
      "max": 3,
      "step": 0.5,
      "default": 2.5,
      "unit": "rem"
    },
    {
      "type": "range",
      "id": "subtitle_font_size",
      "label": "å‰¯æ¨™é¡Œæ–‡å­—å¤§å°",
      "min": 0.8,
      "max": 1.5,
      "step": 0.1,
      "default": 1.1,
      "unit": "rem"
    },
    {
      "type": "range",
      "id": "title_font_weight",
      "label": "æ¨™é¡Œæ–‡å­—ç²—ç´°",
      "min": 100,
      "max": 900,
      "step": 100,
      "default": 300
    },
    {
      "type": "range",
      "id": "title_letter_spacing",
      "label": "æ¨™é¡Œå­—é–“è·",
      "min": 0,
      "max": 10,
      "step": 1,
      "default": 3,
      "unit": "px"
    },
    {
      "type": "checkbox",
      "id": "title_gradient",
      "label": "æ¨™é¡Œæ¼¸å±¤æ•ˆæœ",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_title_badge",
      "label": "é¡¯ç¤ºæ¨™é¡Œå¾½ç« ",
      "default": true
    },
    {
      "type": "text",
      "id": "title_badge_text",
      "label": "æ¨™é¡Œå¾½ç« æ–‡å­—",
      "default": "LIVE SCHEDULE"
    },
    {
      "type": "range",
      "id": "header_margin_bottom",
      "label": "æ¨™é¡Œå€ä¸‹é‚Šè·",
      "min": 40,
      "max": 120,
      "step": 10,
      "default": 80,
      "unit": "px"
    },
    {
      "type": "header",
      "content": "ğŸ·ï¸ åˆ†é è¨­å®š"
    },
    {
      "type": "text",
      "id": "taiwan_tab_text",
      "label": "å°ç£åœ˜éšŠæ¨™ç±¤æ–‡å­—",
      "default": "å°ç£åœ˜éšŠ"
    },
    {
      "type": "text",
      "id": "singapore_tab_text",
      "label": "æ–°é¦¬åœ˜éšŠæ¨™ç±¤æ–‡å­—",
      "default": "æ–°é¦¬åœ˜éšŠ"
    },
    {
      "type": "text",
      "id": "taiwan_team_title",
      "label": "å°ç£åœ˜éšŠæ¨™é¡Œ",
      "default": "å°ç£åœ˜éšŠ"
    }, 
    {
      "type": "text",
      "id": "singapore_team_title",
      "label": "æ–°é¦¬åœ˜éšŠæ¨™é¡Œ",
      "default": "æ–°é¦¬åœ˜éšŠ"
    },
    {
      "type": "checkbox",
      "id": "show_team_title_underline",
      "label": "é¡¯ç¤ºåœ˜éšŠæ¨™é¡Œåº•ç·š",
      "default": true
    },
    {
      "type": "range",
      "id": "tab_padding_vertical",
      "label": "æ¨™ç±¤å‚ç›´å…§è·",
      "min": 10,
      "max": 25,
      "step": 1,
      "default": 15,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "tab_padding_horizontal",
      "label": "æ¨™ç±¤æ°´å¹³å…§è·",
      "min": 20,
      "max": 60,
      "step": 5,
      "default": 40,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "tab_margin_bottom",
      "label": "æ¨™ç±¤å€ä¸‹é‚Šè·",
      "min": 30,
      "max": 100,
      "step": 10,
      "default": 60,
      "unit": "px"
    },
    {
      "type": "header",
      "content": "ğŸ’³ å¡ç‰‡è¨­å®š"
    },
    {
      "type": "range",
      "id": "card_width",
      "label": "å¡ç‰‡å¯¬åº¦",
      "min": 250,
      "max": 400,
      "step": 10,
      "default": 320,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "card_width_mobile",
      "label": "å¡ç‰‡å¯¬åº¦ (æ‰‹æ©Ÿ)",
      "min": 200,
      "max": 320,
      "step": 10,
      "default": 260,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "card_gap",
      "label": "å¡ç‰‡é–“è·",
      "min": 10,
      "max": 50,
      "step": 5,
      "default": 25,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "card_padding",
      "label": "å¡ç‰‡å…§è·",
      "min": 20,
      "max": 50,
      "step": 5,
      "default": 35,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "border_radius",
      "label": "å¡ç‰‡åœ“è§’",
      "min": 0,
      "max": 30,
      "step": 2,
      "default": 20,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "card_hover_lift",
      "label": "æ‡¸åœä¸Šå‡è·é›¢",
      "min": -20,
      "max": 0,
      "step": 2,
      "default": -10,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "card_hover_shadow_opacity",
      "label": "æ‡¸åœé™°å½±é€æ˜åº¦",
      "min": 0,
      "max": 50,
      "step": 5,
      "default": 15,
      "unit": "%"
    },
    {
      "type": "header",
      "content": "â° æ™‚æ®µè¨­å®š"
    },
    {
      "type": "range",
      "id": "slot_gap",
      "label": "æ™‚æ®µé–“è·",
      "min": 10,
      "max": 30,
      "step": 2,
      "default": 18,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "slot_padding",
      "label": "æ™‚æ®µå…§è·",
      "min": 12,
      "max": 25,
      "step": 1,
      "default": 18,
      "unit": "px"
    },
    {
      "type": "checkbox",
      "id": "show_time_icon",
      "label": "é¡¯ç¤ºæ™‚é–“åœ–æ¨™",
      "default": true
    },
    {
      "type": "text",
      "id": "time_icon",
      "label": "æ™‚é–“åœ–æ¨™",
      "default": "â°"
    },
    {
      "type": "header",
      "content": "ğŸ  æ»‘å‹•è¨­å®š"
    },
    {
      "type": "range",
      "id": "scroll_cards_count",
      "label": "æ¯æ¬¡æ»‘å‹•å¡ç‰‡æ•¸",
      "min": 1,
      "max": 5,
      "step": 1,
      "default": 3
    },
    {
      "type": "range",
      "id": "drag_speed",
      "label": "æ‹–æ›³é€Ÿåº¦",
      "min": 1,
      "max": 5,
      "step": 1,
      "default": 2
    },
    {
      "type": "range",
      "id": "touch_sensitivity",
      "label": "è§¸æ§éˆæ•åº¦",
      "min": 10,
      "max": 100,
      "step": 10,
      "default": 50,
      "unit": "%"
    },
    {
      "type": "header",
      "content": "âœ¨ å‹•ç•«è¨­å®š"
    },
    {
      "type": "range",
      "id": "animation_speed",
      "label": "å‹•ç•«é€Ÿåº¦",
      "min": 0.2,
      "max": 1,
      "step": 0.1,
      "default": 0.4,
      "unit": "s"
    },
    {
      "type": "checkbox",
      "id": "show_bg_decoration",
      "label": "é¡¯ç¤ºèƒŒæ™¯è£é£¾",
      "default": true
    },
    {
      "type": "range",
      "id": "bg_decoration_opacity",
      "label": "èƒŒæ™¯è£é£¾é€æ˜åº¦",
      "min": 1,
      "max": 10,
      "step": 1,
      "default": 3,
      "unit": "%"
    },
    {
      "type": "range",
      "id": "bg_animation_duration",
      "label": "èƒŒæ™¯å‹•ç•«æŒçºŒæ™‚é–“",
      "min": 10,
      "max": 60,
      "step": 5,
      "default": 30,
      "unit": "s"
    },
    {
      "type": "header",
      "content": "ğŸ”¤ å­—é«”è¨­å®š"
    },
    {
      "type": "text",
      "id": "font_family",
      "label": "å­—é«”ç³»åˆ—",
      "default": "'Inter', 'Arial', 'Microsoft JhengHei', sans-serif",
      "info": "è¼¸å…¥ CSS å­—é«”åç¨±ï¼Œå¤šå€‹å­—é«”ç”¨é€—è™Ÿåˆ†éš”"
    }
  ],
  "blocks": [
    {
      "type": "day",
      "name": "ğŸ“… æ¯æ—¥æ™‚æ®µ",
      "settings": [
        {
          "type": "select",
          "id": "team",
          "label": "æ‰€å±¬åœ˜éšŠ",
          "options": [
            { "value": "taiwan", "label": "å°ç£åœ˜éšŠ" },
            { "value": "singapore", "label": "æ–°é¦¬åœ˜éšŠ" }
          ],
          "default": "taiwan"
        },
        {
          "type": "text",
          "id": "day_name",
          "label": "æ˜ŸæœŸåç¨±",
          "default": "é€±ä¸€"
        },
        {
          "type": "checkbox",
          "id": "has_stream",
          "label": "ç•¶å¤©æœ‰ç›´æ’­",
          "default": true
        },
        {
          "type": "text",
          "id": "status_text",
          "label": "ç‹€æ…‹æ–‡å­—",
          "default": "ç›´æ’­æ—¥"
        },
        {
          "type": "text",
          "id": "no_stream_text",
          "label": "ç„¡ç›´æ’­æç¤ºæ–‡å­—",
          "default": "æœ¬æ—¥ç„¡ç›´æ’­å®‰æ’"
        },
        {
          "type": "header",
          "content": "æ™‚æ®µ 1"
        },
        {
          "type": "text",
          "id": "slot1_time",
          "label": "æ™‚é–“",
          "default": "14:00 - 16:00"
        },
        {
          "type": "text",
          "id": "slot1_platform",
          "label": "å¹³å°",
          "default": "è¦çš®è³¼ç‰© & Facebook"
        },
        {
          "type": "header",
          "content": "æ™‚æ®µ 2"
        },
        {
          "type": "text",
          "id": "slot2_time",
          "label": "æ™‚é–“",
          "default": "18:00 - 20:00"
        },
        {
          "type": "text",
          "id": "slot2_platform",
          "label": "å¹³å°",
          "default": "TikTok Shop"
        },
        {
          "type": "header",
          "content": "æ™‚æ®µ 3"
        },
        {
          "type": "text",
          "id": "slot3_time",
          "label": "æ™‚é–“",
          "default": "20:00 - 22:00"
        },
        {
          "type": "text",
          "id": "slot3_platform",
          "label": "å¹³å°",
          "default": "YouTube & Instagram"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "APGO ç›´æ’­æ™‚ç¨‹",
      "blocks": [
        {
          "type": "day",
          "settings": {
            "team": "taiwan",
            "day_name": "é€±ä¸€",
            "has_stream": true
          }
        },
        {
          "type": "day",
          "settings": {
            "team": "taiwan",
            "day_name": "é€±äºŒ",
            "has_stream": true
          }
        },
        {
          "type": "day",
          "settings": {
            "team": "singapore",
            "day_name": "é€±ä¸€",
            "has_stream": true
          }
        }
      ]
    }
  ]
}
{% endschema %}