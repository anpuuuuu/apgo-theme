{% comment %}
  è³¼ç‰©è»Šé -ç¶œåˆå„ªæƒ å€å¡Š
  æª”æ¡ˆä½ç½®: sections/cart-combined-offer.liquid
  ä¸»è¦åŠŸèƒ½: æ¢ä»¶å¼å„ªæƒ  + æ¨è–¦åŠ è³¼å•†å“
{% endcomment %}

<!-- å…§è¯é—œéµæ¨£å¼é˜²æ­¢é–ƒçˆ -->
<style>
  /* ç§»é™¤æ‰€æœ‰å¯èƒ½çš„å®¹å™¨èƒŒæ™¯è‰² */
  .shopify-section,
  .shopify-section[class*="cart-combined"],
  [class*="shopify-section-template"][class*="cart_combined"],
  .section-cart-combined {
    background-color: transparent !important;
    background: transparent !important;
    background-image: none !important;
  }
  
  /* ç¢ºä¿ wrapper å®Œå…¨é€æ˜ */
  .combined-offer-wrapper {
    background-color: transparent !important;
    background: transparent !important;
    background-image: none !important;
  }
  
  /* ç¢ºä¿åªæœ‰å…§éƒ¨å®¹å™¨æœ‰èƒŒæ™¯è‰² */
  .combined-offer-section {
    background-color: {{ section.settings.loading_bg_color }} !important;
    min-height: 120px;
  }
</style>

<style>
  /* ========================================
     è³¼ç‰©è»Šç¶œåˆå„ªæƒ å€å¡Š - æ‰‹æ©Ÿç‰ˆå„ªå…ˆè¨­è¨ˆ
     ======================================== */
  
    /* å¤–éƒ¨æ¨™é¡Œ */
.section-title {
  font-size: 18px;
  font-weight: 600;
  color: #ffffff !important;
  margin: 24px 0 16px 0;
  position: relative;
  padding-left: 12px;
}

.section-title::before {
  content: '';
  position: absolute;
  left: 0;
  top: 50%;
  transform: translateY(-50%);
  width: 4px;
  height: 24px;
  background: {% if section.settings.use_accent_gradient %}
    linear-gradient(180deg, {{ section.settings.accent_color_start }}, {{ section.settings.accent_color_end }})
  {% else %}
    {{ section.settings.accent_color_start }}
  {% endif %} !important;
  border-radius: 2px;
  box-shadow: 0 0 8px rgba(255, 107, 53, 0.4);
}

/* å¤–å±¤åŒ…è£å™¨ */
.combined-offer-wrapper {
  width: 100%;
  max-width: 1000px;
  margin: 20px auto 0;
  padding: 0 16px;
  position: relative;
  background: transparent !important;
}
  
  /* ä¸»å®¹å™¨ */
  .combined-offer-section {
    background: linear-gradient(145deg, #2d2d2d, #1a1a1a) !important;
    border: 1px solid #404040 !important;
    border-radius: 12px;
    padding: 20px;
    position: relative;
    overflow: hidden;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  .combined-offer-section:hover {
    border-color: #ff6b35 !important;
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(255, 107, 53, 0.2);
  }
  
  /* é ‚éƒ¨æ©˜è‰²ç·šæ¢ */
  .combined-offer-section::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 3px;
    background: {% if section.settings.use_accent_gradient %}
      linear-gradient(90deg, {{ section.settings.accent_color_start }}, {{ section.settings.accent_color_end }})
    {% else %}
      {{ section.settings.accent_color_start }}
    {% endif %} !important;
  }
  
  /* æ¢ä»¶å„ªæƒ å€åŸŸ */
  .conditional-offer-area {
    margin-bottom: 24px;
    padding-bottom: 20px;
    border-bottom: 1px solid #333333;
  }
  
    /* å„ªæƒ éšå±¤å®¹å™¨ */
  .offer-tiers-container {
    margin-bottom: 20px;
  }
  
  /* å„ªæƒ éšå±¤æ¨™é¡Œ */
  .tiers-title {
    font-size: 14px;
    font-weight: 600;
    color: {{ section.settings.text_color }} !important;
    margin: 0 0 12px 0;
    display: flex;
    align-items: center;
    gap: 8px;
  }
  
  .tiers-title::before {
    content: 'ğŸ†';
    font-size: 16px;
  }
  
  /* å„ªæƒ éšå±¤æ»¾å‹•å®¹å™¨ */
  .offer-tiers-scroll {
    overflow-x: auto;
    overflow-y: hidden;
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: thin;
    scrollbar-color: #ff6b35 #333333;
  }
  
  .offer-tiers-scroll::-webkit-scrollbar {
    height: 4px;
  }
  
  .offer-tiers-scroll::-webkit-scrollbar-track {
    background: #333333 !important;
    border-radius: 2px;
  }
  
  .offer-tiers-scroll::-webkit-scrollbar-thumb {
    background: linear-gradient(90deg, #ff6b35, #f7931e) !important;
    border-radius: 2px;
  }
  
  /* å„ªæƒ éšå±¤åˆ—è¡¨ */
  .offer-tiers {
    display: flex;
    flex-direction: row;
    gap: 12px;
    padding: 4px 0;
    min-width: max-content;
  }
  
  /* å–®å€‹å„ªæƒ éšå±¤ */
  .offer-tier {
    background: linear-gradient(145deg, #2d2d2d, #1a1a1a) !important;
    border: 1px solid #404040 !important;
    border-radius: 8px;
    padding: 12px;
    position: relative;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    overflow: hidden;
    flex: 0 0 200px;
    min-width: 200px;
  }
  
  .offer-tier::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 4px;
    height: 100%;
    background: {% if section.settings.use_accent_gradient %}
      linear-gradient(180deg, {{ section.settings.accent_color_start }}, {{ section.settings.accent_color_end }})
    {% else %}
      {{ section.settings.accent_color_start }}
    {% endif %} !important;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  /* éšå±¤ç‹€æ…‹ */
  .offer-tier.current {
    border-color: #ff6b35 !important;
    transform: translateX(4px);
  }
  
  .offer-tier.current::before {
    background: {% if section.settings.use_accent_gradient %}
      linear-gradient(180deg, #ff6b35, #f7931e)
    {% else %}
      #ff6b35
    {% endif %} !important;
    box-shadow: 0 0 10px rgba(255, 107, 53, 0.5);
  }
  
  .offer-tier.achieved {
    border-color: #4caf50 !important;
    background: linear-gradient(145deg, #2d2d2d, #1a1a1a) !important;
  }
  
  .offer-tier.achieved::before {
    background: linear-gradient(180deg, #4caf50, #45a049) !important;
    box-shadow: 0 0 10px rgba(76, 175, 80, 0.5);
  }
  
  .offer-tier.next {
    border-color: #ff9800 !important;
  }
  
  .offer-tier.next::before {
    background: linear-gradient(180deg, #ff9800, #f57c00) !important;
    box-shadow: 0 0 10px rgba(255, 152, 0, 0.5);
  }
  
  /* éšå±¤å…§å®¹ */
  .tier-content {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-left: 8px;
  }
  
  .tier-info {
    flex: 1;
  }
  
  .tier-amount {
    font-size: 13px;
    font-weight: 600;
    color: {{ section.settings.text_color }} !important;
    margin: 0 0 4px 0;
  }
  
  .tier-benefit {
    font-size: 11px;
    color: {{ section.settings.text_secondary_color }} !important;
    margin: 0;
  }
  
  .tier-description {
    font-size: 10px;
    color: {{ section.settings.text_secondary_color }} !important;
    margin: 2px 0 0 0;
    opacity: 0.8;
    font-style: italic;
  }
  
  .tier-status {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 12px;
    font-weight: 500;
  }
  
  .tier-status.achieved {
    color: #4caf50 !important;
  }
  
  .tier-status.current {
    color: #ff6b35 !important;
  }
  
  .tier-status.next {
    color: #ff9800 !important;
  }
  
  .tier-status-icon {
    font-size: 14px;
  }
  
  .tier-progress {
    width: 60px;
    height: 4px;
    background: #333333 !important;
    border-radius: 2px;
    overflow: hidden;
    position: relative;
  }
  
  .tier-progress-fill {
    height: 100%;
    background: {% if section.settings.use_accent_gradient %}
      linear-gradient(90deg, {{ section.settings.accent_color_start }}, {{ section.settings.accent_color_end }})
    {% else %}
      {{ section.settings.accent_color_start }}
    {% endif %} !important;
    border-radius: 2px;
    transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  .tier-progress-fill.achieved {
    background: linear-gradient(90deg, #4caf50, #45a049) !important;
  }
  
  .tier-progress-fill.current {
    background: linear-gradient(90deg, #ff6b35, #f7931e) !important;
  }
  
  .tier-progress-fill.next {
    background: linear-gradient(90deg, #ff9800, #f57c00) !important;
  }
  
  /* é€²åº¦æ¢å®¹å™¨ */
  .progress-container {
    margin-bottom: 16px;
  }
  
  /* é€²åº¦æ¢æ¨™é¡Œ */
  .progress-title {
    font-size: 14px;
    font-weight: 600;
    color: {{ section.settings.text_color }} !important;
    margin: 0 0 8px 0;
    display: flex;
    align-items: center;
    gap: 8px;
  }
  
  .progress-title::before {
    content: 'ğŸ¯';
    font-size: 16px;
  }
  
  /* é€²åº¦æ¢èƒŒæ™¯ */
  .progress-bar-bg {
    width: 100%;
    height: 8px;
    background: #333333 !important;
    border-radius: 4px;
    overflow: hidden;
    position: relative;
  }
  
  /* é€²åº¦æ¢å¡«å…… */
  .progress-bar-fill {
    height: 100%;
    background: {% if section.settings.use_accent_gradient %}
      linear-gradient(90deg, {{ section.settings.accent_color_start }}, {{ section.settings.accent_color_end }})
    {% else %}
      {{ section.settings.accent_color_start }}
    {% endif %} !important;
    border-radius: 4px;
    transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
  }
  
  /* é€²åº¦æ¢å‹•ç•«æ•ˆæœ */
  .progress-bar-fill::after {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
    animation: shimmer 2s infinite;
  }
  
  @keyframes shimmer {
    0% { left: -100%; }
    100% { left: 100%; }
  }
  
  /* é€²åº¦æ–‡å­— */
  .progress-text {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 8px;
    font-size: 12px;
    color: {{ section.settings.text_secondary_color }} !important;
  }
  
  .current-amount {
    font-weight: 600;
    color: {{ section.settings.accent_color_start }} !important;
  }
  
  .target-amount {
    font-weight: 500;
  }
  
  /* å„ªæƒ è¨Šæ¯å®¹å™¨ */
  .offer-message-container {
    margin-top: 16px;
  }
  
  /* å„ªæƒ è¨Šæ¯ */
  .offer-message {
    font-size: 13px;
    line-height: 1.4;
    color: {{ section.settings.text_color }} !important;
    margin: 0;
    padding: 12px;
    border-radius: 8px;
    background: rgba(255, 107, 53, 0.1) !important;
    border: 1px solid rgba(255, 107, 53, 0.2) !important;
    position: relative;
    overflow: hidden;
  }
  
  .offer-message::before {
    content: 'ğŸ’¡';
    position: absolute;
    left: 12px;
    top: 50%;
    transform: translateY(-50%);
    font-size: 16px;
  }
  
  .offer-message .message-text {
    margin-left: 32px;
  }
  
  /* å·²é”æˆå„ªæƒ æ¨£å¼ */
  .offer-message.achieved {
    background: rgba(76, 175, 80, 0.1) !important;
    border-color: rgba(76, 175, 80, 0.3) !important;
  }
  
  .offer-message.achieved::before {
    content: 'ğŸ‰';
    font-size: 16px;
  }
  
  /* å„ªæƒ é‡‘é¡å¼·èª¿ */
  .offer-amount {
    font-weight: 700;
    color: {{ section.settings.accent_color_start }} !important;
    text-shadow: 0 0 8px rgba(255, 107, 53, 0.3);
  }
  
  /* æ¨è–¦å•†å“å€åŸŸ */
  .upsell-area {
    margin-top: 20px;
  }
  
  /* æ¨è–¦æ¨™é¡Œ */
  .upsell-title {
    font-size: 16px;
    font-weight: 600;
    color: {{ section.settings.text_color }} !important;
    margin: 0 0 12px 0;
    position: relative;
    padding-left: 12px;
  }
  
  .upsell-title::before {
    content: '';
    position: absolute;
    left: 0;
    top: 50%;
    transform: translateY(-50%);
    width: 3px;
    height: 18px;
    background: {% if section.settings.use_accent_gradient %}
      linear-gradient(135deg, {{ section.settings.accent_color_start }}, {{ section.settings.accent_color_end }})
    {% else %}
      {{ section.settings.accent_color_start }}
    {% endif %} !important;
    border-radius: 2px;
  }
  
  /* å•†å“æ»‘å‹•å®¹å™¨ */
  .upsell-slider-container {
    position: relative;
    overflow: hidden;
    margin: 0 -8px;
    padding: 0 8px;
  }
  
  .upsell-slider {
    display: flex;
    gap: 10px;
    overflow-x: auto;
    scroll-behavior: smooth;
    padding: 8px 0;
    scrollbar-width: thin;
    scrollbar-color: #ff6b35 #333333;
    -webkit-overflow-scrolling: touch;
  }
  
  .upsell-slider::-webkit-scrollbar {
    height: 4px;
  }
  
  .upsell-slider::-webkit-scrollbar-track {
    background: #333333 !important;
    border-radius: 2px;
  }
  
  .upsell-slider::-webkit-scrollbar-thumb {
    background: linear-gradient(90deg, #ff6b35, #f7931e) !important;
    border-radius: 2px;
  }
  
  /* å•†å“å¡ç‰‡ */
  .upsell-product-card {
    flex: 0 0 var(--card-width-desktop, 280px);
    background: linear-gradient(145deg, #2d2d2d, #1a1a1a) !important;
    border: 1px solid #404040 !important;
    border-radius: 8px;
    padding: 12px 8px;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
    text-decoration: none;
    display: flex;
    align-items: center;
    gap: 8px;
  }
  
  .upsell-product-card:hover {
    border-color: #ff6b35 !important;
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(255, 107, 53, 0.2);
  }
  
  /* å•†å“åœ–ç‰‡ */
  .upsell-product-image {
    width: 50px;
    height: 60px;
    border-radius: 6px;
    overflow: hidden;
    position: relative;
    flex-shrink: 0;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  
  .upsell-product-image img {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: contain;
    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  /* Placeholder SVG æ¨£å¼ */
  .upsell-product-image .placeholder-svg {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    opacity: 0.3;
    filter: invert(1);
  }
  
  /* ç”¢å“é€£çµæ¨£å¼ */
  .upsell-product-link {
    display: flex;
    align-items: center;
    gap: 10px;
    flex: 1;
    text-decoration: none;
    color: inherit;
  }
  
  .upsell-product-card:hover .upsell-product-title {
    color: #ff6b35 !important;
  }
  
  /* å•†å“è³‡è¨Š */
  .upsell-product-info {
    flex: 1;
    min-width: 0;
    display: flex;
    flex-direction: column;
    gap: 3px;
  }
  
  .upsell-product-title {
    font-size: 12px;
    font-weight: 500;
    color: {{ section.settings.text_color }} !important;
    margin: 0;
    overflow: hidden;
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-line-clamp: 1;
    -webkit-box-orient: vertical;
    line-height: 1.3;
  }
  
  .upsell-product-price {
    font-size: 13px;
    font-weight: 700;
    color: {{ section.settings.accent_color_start }} !important;
    margin: 0;
    text-shadow: 0 0 8px rgba(255, 107, 53, 0.3);
  }
  
  /* åŠ å…¥è³¼ç‰©è»ŠæŒ‰éˆ• */
  .upsell-add-to-cart {
    width: 32px;
    height: 32px;
    background: transparent !important;
    border: 2px solid {{ section.settings.accent_color_start }} !important;
    border-radius: 6px;
    color: {{ section.settings.accent_color_start }} !important;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    overflow: hidden;
    flex-shrink: 0;
    outline: none !important;
    -webkit-tap-highlight-color: transparent;
  }
  
  .upsell-add-to-cart:focus {
    outline: none !important;
    box-shadow: none !important;
  }
  
  .upsell-add-to-cart:focus-visible {
    outline: none !important;
    box-shadow: 0 0 0 2px {{ section.settings.accent_color_start }}40 !important;
  }
  
  .upsell-add-to-cart:active {
    transform: scale(0.95);
  }
  
  .upsell-add-to-cart * {
    pointer-events: none;
  }
  
  .upsell-add-to-cart::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: {% if section.settings.use_accent_gradient %}
      linear-gradient(135deg, {{ section.settings.accent_color_start }}, {{ section.settings.accent_color_end }})
    {% else %}
      {{ section.settings.accent_color_start }}
    {% endif %} !important;
    transition: left 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    z-index: 0;
  }
  
  .upsell-add-to-cart:hover::before {
    left: 0;
  }
  
  .upsell-add-to-cart span {
    position: relative;
    z-index: 1;
    transition: color 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  .upsell-add-to-cart:hover {
    border-color: #ff6b35 !important;
    color: #ffffff !important;
  }
  
  .upsell-add-to-cart:hover span {
    color: #ffffff !important;
  }
  
  .upsell-add-to-cart.loading {
    pointer-events: none;
    opacity: 0.7;
  }
  
  .upsell-add-to-cart.added {
    border-color: {{ section.settings.accent_color_start }} !important;
    color: {{ section.settings.accent_color_start }} !important;
  }
  
  .upsell-add-to-cart.added span {
    color: {{ section.settings.accent_color_start }} !important;
  }
  
  /* è¼‰å…¥ç‹€æ…‹ */
  .combined-offer-section.loading {
    min-height: 150px;
    position: relative;
  }
  
  .combined-offer-section.loading::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 40px;
    height: 40px;
    border: 3px solid #333333 !important;
    border-top-color: #ff6b35 !important;
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
  }
  
  @keyframes spin {
    to { transform: translate(-50%, -50%) rotate(360deg); }
  }
  
    /* éŸ¿æ‡‰å¼è¨­è¨ˆ */
@media (max-width: 768px) {
  .section-title {
    font-size: 16px;
    margin: 20px 0 12px 0;
    padding-left: 10px;
  }
  
  .section-title::before {
    width: 4px;
    height: 20px;
    box-shadow: 0 0 6px rgba(255, 107, 53, 0.4);
  }
  
      .combined-offer-wrapper {
    padding: 0 12px;
    margin: 16px auto 0;
  }
  
  .combined-offer-section {
    padding: 16px;
    border-radius: 10px;
  }
    
        .conditional-offer-area {
    margin-bottom: 20px;
    padding-bottom: 16px;
  }
    
    .tiers-title {
      font-size: 13px;
      margin-bottom: 10px;
    }
    
    .offer-tier {
      padding: 12px;
      flex: 0 0 220px;
      min-width: 220px;
    }
    
    .tier-amount {
      font-size: 13px;
    }
    
    .tier-benefit {
      font-size: 11px;
    }
    
    .tier-description {
      font-size: 10px;
    }
    
    .tier-status {
      font-size: 12px;
    }
    
    .tier-progress {
      width: 60px;
      height: 4px;
    }
    
    .progress-title {
      font-size: 14px;
    }
    
    .offer-message {
      font-size: 12px;
      padding: 10px;
    }
    
    .upsell-title {
      font-size: 14px;
      margin-bottom: 10px;
    }
    
    .upsell-product-card {
      flex: 0 0 240px;
      padding: 10px 6px;
    }
    
    .upsell-product-image {
      width: 45px;
      height: 55px;
    }
    
    .upsell-product-title {
      font-size: 11px;
    }
    
    .upsell-product-price {
      font-size: 12px;
    }
    
    .upsell-add-to-cart {
      width: 28px;
      height: 28px;
      font-size: 14px;
    }
  }
  
    @media (max-width: 480px) {
  .section-title {
    font-size: 15px;
    margin: 16px 0 10px 0;
    padding-left: 10px;
  }
  
  .section-title::before {
    width: 4px;
    height: 18px;
    box-shadow: 0 0 4px rgba(255, 107, 53, 0.4);
  }
  
  .offer-tier {
    flex: 0 0 280px;
    min-width: 280px;
    padding: 10px;
  }
    
    .tier-amount {
      font-size: 12px;
    }
    
    .tier-benefit {
      font-size: 10px;
    }
    
    .tier-description {
      font-size: 9px;
    }
    
    .tier-status {
      font-size: 11px;
    }
    
    .tier-progress {
      width: 50px;
      height: 3px;
    }
    
    .upsell-product-card {
      flex: 0 0 200px;
    }
    
    .upsell-product-image {
      width: 40px;
      height: 50px;
    }
    
    .upsell-product-title {
      font-size: 10px;
    }
    
    .upsell-product-price {
      font-size: 11px;
    }
    
    .upsell-add-to-cart {
      width: 26px;
      height: 26px;
      font-size: 12px;
    }
  }
  
  /* éš±è—é¸é … */
  .combined-offer-wrapper[data-hide-progress="true"] .progress-container {
    display: none;
  }
  
  .combined-offer-wrapper[data-hide-conditional="true"] .conditional-offer-area {
    display: none;
  }
  
  .combined-offer-wrapper[data-hide-upsell="true"] .upsell-area {
    display: none;
  }
</style>

<div class="combined-offer-wrapper"
     data-hide-progress="{{ section.settings.hide_progress }}"
     data-hide-conditional="{{ section.settings.hide_conditional }}"
     data-hide-upsell="{{ section.settings.hide_upsell }}">
  
  <!-- å°ˆå±¬å„ªæƒ åˆ¸æ¨™é¡Œ -->
  {% unless section.settings.hide_conditional %}
  <h4 class="section-title">å°ˆå±¬å„ªæƒ åˆ¸</h4>
  {% endunless %}
  
  <div class="combined-offer-section" id="combined-offer-{{ section.id }}">
    
    <!-- æ¢ä»¶å„ªæƒ å€åŸŸ -->
    {% unless section.settings.hide_conditional %}
    <div class="conditional-offer-area">
      <!-- é€²åº¦æ¢å€åŸŸ -->
      {% unless section.settings.hide_progress %}
      <div class="progress-container">
        <h4 class="progress-title" id="progress-title-{{ section.id }}">è·é›¢ç›®æ¨™é‚„å·®</h4>
        <div class="progress-bar-bg">
          <div class="progress-bar-fill" id="progress-fill-{{ section.id }}" style="width: 0%"></div>
        </div>
        <div class="progress-text">
          <span class="current-amount" id="current-amount-{{ section.id }}">NT$ 0</span>
          <span class="target-amount" id="target-amount-{{ section.id }}">NT$ 0</span>
        </div>
      </div>
      {% endunless %}
      
      <!-- å„ªæƒ éšå±¤å€åŸŸ -->
      <div class="offer-tiers-container">
        <div class="offer-tiers-scroll" id="offer-tiers-scroll-{{ section.id }}">
          <div class="offer-tiers" id="offer-tiers-{{ section.id }}">
            <!-- å„ªæƒ éšå±¤å°‡ç”± JavaScript å‹•æ…‹ç”Ÿæˆ -->
          </div>
        </div>
      </div>
      
      <!-- å„ªæƒ è¨Šæ¯å€åŸŸ -->
      <div class="offer-message-container">
        <div class="offer-message" id="offer-message-{{ section.id }}">
          <div class="message-text">
            <span id="offer-text-{{ section.id }}">{{ section.settings.initial_message }}</span>
          </div>
        </div>
      </div>
    </div>
    {% endunless %}
    
    <!-- æ¨è–¦å•†å“å€åŸŸ -->
    {% unless section.settings.hide_upsell %}
    <div class="upsell-area">
      <h4 class="upsell-title">{{ section.settings.upsell_title }}</h4>
      <div class="upsell-slider-container">
        <div class="upsell-slider" id="upsell-slider-{{ section.id }}">
          {% if section.settings.product_list != blank %}
            {% for product in section.settings.product_list limit: section.settings.max_products %}
              <div class="upsell-product-card">
                <a href="{{ product.url }}" class="upsell-product-link">
                  <div class="upsell-product-image">
                    {% if product.featured_image %}
                      <img src="{{ product.featured_image | image_url: width: 200 }}"
                           alt="{{ product.title | escape }}"
                           width="200"
                           height="240"
                           loading="lazy">
                    {% else %}
                      {{ 'product-1' | placeholder_svg_tag: 'placeholder-svg' }}
                    {% endif %}
                  </div>
                  <div class="upsell-product-info">
                    <h5 class="upsell-product-title">{{ product.title }}</h5>
                    {% if section.settings.show_prices %}
                      <p class="upsell-product-price">{{ product.price | money }}</p>
                    {% endif %}
                  </div>
                </a>
                {% if section.settings.enable_quick_add %}
                  <button type="button" 
                          class="upsell-add-to-cart"
                          data-variant-id="{{ product.selected_or_first_available_variant.id }}"
                          data-product-id="{{ product.id }}"
                          onclick="event.preventDefault(); event.stopPropagation(); addToCartCombined(this, event);">
                    <span>+</span>
                  </button>
                {% endif %}
              </div>
            {% endfor %}
          {% else %}
            <!-- é è¨­å•†å“é¡¯ç¤ºï¼ˆç·¨è¼¯å™¨é è¦½ç”¨ï¼‰ -->
            {% for i in (1..4) %}
              <div class="upsell-product-card">
                <div class="upsell-product-image">
                  {{ 'product-' | append: i | placeholder_svg_tag: 'placeholder-svg' }}
                </div>
                <div class="upsell-product-info">
                  <h5 class="upsell-product-title">ç¯„ä¾‹å•†å“ {{ i }}</h5>
                  {% if section.settings.show_prices %}
                    <p class="upsell-product-price">NT$ {{ i | times: 580 }}</p>
                  {% endif %}
                </div>
                {% if section.settings.enable_quick_add %}
                  <button type="button" class="upsell-add-to-cart" disabled>
                    <span>+</span>
                  </button>
                {% endif %}
              </div>
            {% endfor %}
          {% endif %}
        </div>
      </div>
    </div>
    {% endunless %}
    
  </div>
</div>

<script>
  // ç¶œåˆå„ªæƒ åŠŸèƒ½
  class CombinedOffer {
    constructor(sectionId, settings) {
      this.sectionId = sectionId;
      this.settings = settings;
      this.currentAmount = 0;
      this.targetAmount = 0;
      this.tiers = this.parseTiers(settings.tiers);
      this.init();
    }
    
    parseTiers(blocks) {
      if (!blocks || !Array.isArray(blocks)) return [];
      
      return blocks.map(block => ({
        id: block.id,
        amount: parseFloat(block.amount) || 0,
        benefit: block.benefit || '',
        description: block.description || ''
      })).sort((a, b) => a.amount - b.amount);
    }
    
    init() {
      this.updateCartAmount();
      this.setupEventListeners();
      this.interceptRequests(); // æ””æˆª /cart/* è«‹æ±‚
    }
    
    interceptRequests() {
      if (window.__coFetchPatched) return;
      window.__coFetchPatched = true;

      const originalFetch = window.fetch;
      window.fetch = async (...args) => {
        const resp = await originalFetch(...args);
        try {
          const url = (args[0] && (args[0].url || args[0])) || '';
          if (typeof url === 'string' && (/\/cart\/(add|change|update|clear)/.test(url))) {
            setTimeout(() => this.updateCartAmount(), 200);
          }
        } catch(_) {}
        return resp;
      };

      // å¯é¸ï¼šè£œ XHR
      if (!window.__coXhrPatched) {
        window.__coXhrPatched = true;
        const origOpen = XMLHttpRequest.prototype.open;
        XMLHttpRequest.prototype.open = function(method, url, ...rest) {
          this.addEventListener('loadend', () => {
            try {
              if (typeof url === 'string' && (/\/cart\/(add|change|update|clear)/.test(url))) {
                setTimeout(() => document.dispatchEvent(new Event('cart:update')), 200);
              }
            } catch(_) {}
          });
          return origOpen.call(this, method, url, ...rest);
        };
      }
    }
    
    updateCartAmount() {
      // å–å¾—è³¼ç‰©è»Šç¸½é‡‘é¡
      fetch(`/cart.js?_=${Date.now()}`, { cache: 'no-store' })
        .then(response => response.json())
        .then(cart => {
          this.currentAmount = cart.total_price / 100; // è½‰æ›ç‚ºå…ƒ
          this.updateDisplay();
        })
        .catch(error => {
          console.error('ç„¡æ³•å–å¾—è³¼ç‰©è»Šè³‡æ–™:', error);
        });
    }
    
    updateDisplay() {
      const progressFill = document.getElementById(`progress-fill-${this.sectionId}`);
      const currentAmountEl = document.getElementById(`current-amount-${this.sectionId}`);
      const progressTitleEl = document.getElementById(`progress-title-${this.sectionId}`);
      const offerMessage = document.getElementById(`offer-message-${this.sectionId}`);
      const offerText = document.getElementById(`offer-text-${this.sectionId}`);
      
      // åˆå§‹åŒ–é‡‘é¡æ ¼å¼åŒ–å™¨
      const fmt = new Intl.NumberFormat('zh-TW', { 
        style: 'currency', 
        currency: '{{ cart.currency.iso_code | default: "TWD" }}', 
        minimumFractionDigits: 0 
      });
      
      // æ›´æ–°å„ªæƒ éšå±¤
      this.updateTiers();
      
      // å‹•æ…‹æ›´æ–°ç›®æ¨™é‡‘é¡å’Œé€²åº¦æ¢
      const nextTier = this.getNextTier();
      if (nextTier) {
        this.targetAmount = nextTier.amount;
        
        // æ›´æ–°é€²åº¦æ¢æ¨™é¡Œ
        if (progressTitleEl) {
          progressTitleEl.textContent = `è·é›¢${nextTier.benefit}é‚„å·®`;
        }
        
        // æ›´æ–°é€²åº¦æ¢
        if (progressFill) {
          const progress = Math.min((this.currentAmount / this.targetAmount) * 100, 100);
          progressFill.style.width = `${progress}%`;
        }
        
        // æ›´æ–°ç›®æ¨™é‡‘é¡é¡¯ç¤º
        const targetAmountEl = document.getElementById(`target-amount-${this.sectionId}`);
        if (targetAmountEl) {
          targetAmountEl.textContent = fmt.format(this.targetAmount);
        }
      }
      
      // æ›´æ–°é‡‘é¡é¡¯ç¤º
      if (currentAmountEl) {
        currentAmountEl.textContent = fmt.format(this.currentAmount);
      }
      
      // æ›´æ–°å„ªæƒ è¨Šæ¯
      if (offerMessage && offerText) {
        const currentTier = this.getCurrentTier();
        const nextTier = this.getNextTier();
        
        if (currentTier && nextTier) {
          // æœ‰ä¸‹ä¸€å€‹ç›®æ¨™
          offerMessage.classList.remove('achieved');
          const allBenefits = this.getAllAchievedBenefits();
          const message = `æ­å–œï¼æ‚¨å·²äº«æœ‰ ${allBenefits}ï¼ŒåŠ è³¼è‡³ <span class="offer-amount">${fmt.format(nextTier.amount)}</span> å³äº«æœ‰ <span class="offer-amount">${nextTier.benefit}</span>ï¼`;
          offerText.innerHTML = message;
        } else if (currentTier && !nextTier) {
          // å·²é”åˆ°æœ€é«˜éšå±¤
          offerMessage.classList.add('achieved');
          const allBenefits = this.getAllAchievedBenefits();
          offerText.innerHTML = `æ­å–œï¼æ‚¨å·²äº«æœ‰ ${allBenefits}ï¼`;
        } else {
          // é‚„æ²’æœ‰é”åˆ°ä»»ä½•éšå±¤
          offerMessage.classList.remove('achieved');
          if (this.tiers.length > 0) {
            const firstTier = this.tiers[0];
            const message = `åŠ è³¼è‡³ <span class="offer-amount">${fmt.format(firstTier.amount)}</span> å³äº«æœ‰ <span class="offer-amount">${firstTier.benefit}</span>ï¼`;
            offerText.innerHTML = message;
          } else {
            offerText.innerHTML = this.settings.initial_message;
          }
        }
      }
      
      // è‡ªå‹•æ»¾å‹•åˆ°ä¸‹ä¸€å€‹ç›®æ¨™
      this.scrollToNextTarget();
    }
    
    getAllAchievedBenefits() {
      const achievedTiers = this.tiers.filter(tier => this.currentAmount >= tier.amount);
      if (achievedTiers.length === 0) return '';
      
      const benefits = achievedTiers.map(tier => `<span class="offer-amount">${tier.benefit}</span>`);
      
      if (benefits.length === 1) {
        return benefits[0];
      } else if (benefits.length === 2) {
        return `${benefits[0]} å’Œ ${benefits[1]}`;
      } else {
        const lastBenefit = benefits.pop();
        return `${benefits.join('ã€')} å’Œ ${lastBenefit}`;
      }
    }
    
    scrollToNextTarget() {
      const scrollContainer = document.getElementById(`offer-tiers-scroll-${this.sectionId}`);
      const nextTier = this.getNextTier();
      
      if (scrollContainer && nextTier) {
        const nextTierElement = scrollContainer.querySelector(`[data-tier-id="${nextTier.id}"]`);
        if (nextTierElement) {
          const containerRect = scrollContainer.getBoundingClientRect();
          const elementRect = nextTierElement.getBoundingClientRect();
          const scrollLeft = scrollContainer.scrollLeft;
          
          // è¨ˆç®—éœ€è¦æ»¾å‹•çš„è·é›¢
          const targetScrollLeft = scrollLeft + elementRect.left - containerRect.left - (containerRect.width / 2) + (elementRect.width / 2);
          
          scrollContainer.scrollTo({
            left: targetScrollLeft,
            behavior: 'smooth'
          });
        }
      }
    }
    
    getCurrentTier() {
      // æ‰¾åˆ°ç•¶å‰å·²é”æˆçš„æœ€é«˜éšå±¤
      for (let i = this.tiers.length - 1; i >= 0; i--) {
        if (this.currentAmount >= this.tiers[i].amount) {
          return this.tiers[i];
        }
      }
      return null;
    }
    
    getNextTier() {
      // æ‰¾åˆ°ä¸‹ä¸€å€‹è¦é”æˆçš„éšå±¤
      for (let i = 0; i < this.tiers.length; i++) {
        if (this.currentAmount < this.tiers[i].amount) {
          return this.tiers[i];
        }
      }
      return null;
    }
    
    updateTiers() {
      const tiersContainer = document.getElementById(`offer-tiers-${this.sectionId}`);
      if (!tiersContainer || this.tiers.length === 0) return;
      
      tiersContainer.innerHTML = '';
      
      this.tiers.forEach((tier, index) => {
        const tierElement = this.createTierElement(tier, index);
        tiersContainer.appendChild(tierElement);
      });
    }
    
    createTierElement(tier, index) {
      const tierDiv = document.createElement('div');
      tierDiv.className = 'offer-tier';
      tierDiv.setAttribute('data-tier-id', tier.id);
      
      const isAchieved = this.currentAmount >= tier.amount;
      const isCurrent = this.currentAmount < tier.amount && 
                       (index === 0 || this.currentAmount >= this.tiers[index - 1].amount);
      const isNext = !isAchieved && !isCurrent;
      
      if (isAchieved) {
        tierDiv.classList.add('achieved');
      } else if (isCurrent) {
        tierDiv.classList.add('current');
      } else if (isNext) {
        tierDiv.classList.add('next');
      }
      
      const progress = Math.min((this.currentAmount / tier.amount) * 100, 100);
      
      // åˆå§‹åŒ–é‡‘é¡æ ¼å¼åŒ–å™¨
      const fmt = new Intl.NumberFormat('zh-TW', { 
        style: 'currency', 
        currency: '{{ cart.currency.iso_code | default: "TWD" }}', 
        minimumFractionDigits: 0 
      });
      
      tierDiv.innerHTML = `
        <div class="tier-content">
          <div class="tier-info">
            <div class="tier-amount">${fmt.format(tier.amount)}</div>
            <div class="tier-benefit">${tier.benefit}</div>
            ${tier.description ? `<div class="tier-description">${tier.description}</div>` : ''}
          </div>
          <div class="tier-status ${isAchieved ? 'achieved' : isCurrent ? 'current' : 'next'}">
            <span class="tier-status-icon">
              ${isAchieved ? 'âœ…' : isCurrent ? 'ğŸ¯' : 'â³'}
            </span>
            <span>${isAchieved ? 'å·²é”æˆ' : isCurrent ? 'é€²è¡Œä¸­' : 'å¾…é”æˆ'}</span>
            <div class="tier-progress">
              <div class="tier-progress-fill ${isAchieved ? 'achieved' : isCurrent ? 'current' : 'next'}" 
                   style="width: ${progress}%"></div>
            </div>
          </div>
        </div>
      `;
      
      return tierDiv;
    }
    
    setupEventListeners() {
      const debounce = (fn, wait = 250) => { let t; return (...a) => { clearTimeout(t); t = setTimeout(() => fn.apply(this, a), wait); }; };
      const debouncedUpdate = debounce(() => this.updateCartAmount(), 250);

      const EVENT_NAMES = [
        'cart:refresh','cart:updated','cart:update','cart:change',
        'product:added','ajaxProduct:added','cart:request:complete',
        'theme:cart:update','CartUpdateEvent'
      ];
      const targets = [document, document.documentElement, window];

      // é˜²é‡ï¼šå¦‚æœä¹‹å‰æœ‰ç¶ï¼Œå…ˆç§»é™¤
      window.__coCombListeners = window.__coCombListeners || {};
      const key = this.sectionId;
      if (window.__coCombListeners[key]) {
        const { targets: oldTargets, names, handler } = window.__coCombListeners[key];
        oldTargets.forEach(t => {
          names.forEach(n => t.removeEventListener(n, handler));
          t.removeEventListener('CartUpdateEvent', handler);
        });
      }

      targets.forEach(t => {
        EVENT_NAMES.forEach(n => t.addEventListener(n, debouncedUpdate, { passive: true }));
        t.addEventListener('CartUpdateEvent', debouncedUpdate, { passive: true });
      });
      window.__coCombListeners[key] = { targets, names: EVENT_NAMES, handler: debouncedUpdate };

      // åˆ†é åˆ‡å›æ™‚ä¹Ÿæ›´æ–°
      document.addEventListener('visibilitychange', () => {
        if (!document.hidden) this.updateCartAmount();
      });
    }
  }
  
  // åŠ å…¥è³¼ç‰©è»ŠåŠŸèƒ½
  function addToCartCombined(button, event) {
    event.preventDefault();
    event.stopPropagation();
    
    const variantId = button.dataset.variantId;
    const productId = button.dataset.productId;
    
    if (!variantId) return;
    
    // é¡¯ç¤ºè¼‰å…¥ç‹€æ…‹
    button.classList.add('loading');
    button.innerHTML = '<span>...</span>';
    
    // ä½¿ç”¨ Shopify Cart API
    const root = (window.Shopify && window.Shopify.routes && window.Shopify.routes.root) ? window.Shopify.routes.root : '/';
    fetch(root + 'cart/add.js', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Accept': 'application/json'
      },
      body: JSON.stringify({
        items: [{
          id: parseInt(variantId),
          quantity: 1
        }]
      })
    })
    .then(response => response.json())
    .then(data => {
      // æˆåŠŸåŠ å…¥è³¼ç‰©è»Š
      button.classList.remove('loading');
      button.classList.add('added');
      button.innerHTML = '<span>âœ“</span>';
      
      // æ›´æ–°æ¢ä»¶å¼å„ªæƒ é¡¯ç¤º
      const sectionId = button.closest('.combined-offer-section').id.replace('combined-offer-', '');
      const combinedOffer = window.combinedOffers && window.combinedOffers[sectionId];
      if (combinedOffer) {
        setTimeout(() => combinedOffer.updateCartAmount(), 100);
      }
      
      // Savor/Horizon AI ä¸»é¡Œå°ˆç”¨æ›´æ–°æ–¹æ³•
      console.log('ğŸ”„ é–‹å§‹æ›´æ–°è³¼ç‰©è»Š...');
      
      import('@theme/events').then(({ CartUpdateEvent }) => {
        console.log('âœ… æˆåŠŸè¼‰å…¥ @theme/events');
        const cartDrawer = document.querySelector('cart-drawer-component');
        
        // å–å¾—æœ€æ–°è³¼ç‰©è»Šè³‡æ–™
        fetch(`/cart.js?_=${Date.now()}`, { cache: 'no-store' })
          .then(res => res.json())
          .then(cart => {
            console.log('ğŸ“¦ è³¼ç‰©è»Šè³‡æ–™:', cart);
            
            // å»£æ’­é€šç”¨äº‹ä»¶
            document.dispatchEvent(new CustomEvent('cart:update', { detail: { cart } }));
            
            // ç™¼é€ CartUpdateEvent
            const event = new CartUpdateEvent(cart, 'manual-trigger', {
              itemCount: cart.item_count,
              source: 'combined-offer-block',
              sections: {}
            });
            console.log('ğŸ“¤ ç™¼é€ CartUpdateEvent');
            document.dispatchEvent(event);
            
            // æ›´æ–°æ¢ä»¶å¼å„ªæƒ é¡¯ç¤º
            setTimeout(() => {
              const combinedOffer = window.combinedOffers && window.combinedOffers[sectionId];
              if (combinedOffer) {
                combinedOffer.updateCartAmount();
              }
            }, 300);
            
            // é–‹å•Ÿè³¼ç‰©è»ŠæŠ½å±œ
            if (cartDrawer) {
              console.log('ğŸ” æ‰¾åˆ°è³¼ç‰©è»ŠæŠ½å±œ:', cartDrawer);
              if (cartDrawer.hasAttribute('auto-open')) {
                console.log('ğŸšª å˜—è©¦é–‹å•Ÿè³¼ç‰©è»ŠæŠ½å±œ (auto-open)');
                cartDrawer.open();
              } else {
                console.log('ğŸšª å˜—è©¦é–‹å•Ÿè³¼ç‰©è»ŠæŠ½å±œ (æ‰‹å‹•)');
                if (typeof cartDrawer.open === 'function') {
                  cartDrawer.open();
                } else if (typeof cartDrawer.toggle === 'function') {
                  cartDrawer.toggle(true);
                }
              }
            }
          });
      }).catch((error) => {
        console.error('âŒ ç„¡æ³•è¼‰å…¥ @theme/events:', error);
        console.log('ğŸ”„ ä½¿ç”¨å‚™ç”¨æ–¹æ³•æ›´æ–°è³¼ç‰©è»Š...');
        
        // å‚™ç”¨æ–¹æ³•
        const cartDrawer = document.querySelector('cart-drawer-component, cart-drawer, .cart-drawer');
        
        // å˜—è©¦è§¸ç™¼è³¼ç‰©è»Šæ›´æ–°
        fetch(`/cart.js?_=${Date.now()}`, { cache: 'no-store' })
          .then(res => res.json())
          .then(cart => {
            // å»£æ’­é€šç”¨äº‹ä»¶
            document.dispatchEvent(new CustomEvent('cart:update', { detail: { cart } }));
            
            // æ¨™æº– cart:refresh äº‹ä»¶
            document.documentElement.dispatchEvent(new CustomEvent('cart:refresh', {
              bubbles: true,
              detail: { cart: cart }
            }));
            
            // æ›´æ–°æ¢ä»¶å¼å„ªæƒ é¡¯ç¤º
            setTimeout(() => {
              const combinedOffer = window.combinedOffers && window.combinedOffers[sectionId];
              if (combinedOffer) {
                combinedOffer.updateCartAmount();
              }
            }, 300);
            
            // å˜—è©¦é–‹å•Ÿè³¼ç‰©è»Š
            if (cartDrawer && typeof cartDrawer.open === 'function') {
              cartDrawer.open();
            } else {
              // å˜—è©¦é»æ“Šè³¼ç‰©è»ŠæŒ‰éˆ•
              const cartButton = document.querySelector('[data-cart-drawer-toggle], [data-cart-toggle], .cart-toggle');
              if (cartButton) cartButton.click();
            }
          });
      });
      
      // 3ç§’å¾Œæ¢å¾©åŸç‹€
      setTimeout(() => {
        button.classList.remove('added');
        button.innerHTML = '<span>+</span>';
      }, 3000);
    })
    .catch(error => {
      console.error('åŠ å…¥è³¼ç‰©è»Šå¤±æ•—:', error);
      button.classList.remove('loading');
      button.innerHTML = '<span>âœ—</span>';
      
      setTimeout(() => {
        button.innerHTML = '<span>+</span>';
      }, 2000);
    });
  }
  
  // åˆå§‹åŒ–ç¶œåˆå„ªæƒ 
  document.addEventListener('DOMContentLoaded', function() {
    const section = document.getElementById('combined-offer-{{ section.id }}');
    if (section) {
      // åˆå§‹åŒ–å…¨åŸŸè®Šæ•¸
      if (!window.combinedOffers) {
        window.combinedOffers = {};
      }
      
      window.combinedOffers['{{ section.id }}'] = new CombinedOffer('{{ section.id }}', {
        initial_message: `{{ section.settings.initial_message | escape }}`,
        tiers: [
          {% for block in section.blocks %}
            {% if block.type == 'tier' %}
              {
                id: '{{ block.id }}',
                amount: {{ block.settings.amount | default: 0 }},
                benefit: '{{ block.settings.benefit | escape }}',
                description: '{{ block.settings.description | escape }}'
              }{% unless forloop.last %},{% endunless %}
            {% endif %}
          {% endfor %}
        ]
      });
    }
  });
</script>

{% schema %}
{
  "name": "è³¼ç‰©è»Šé -ç¶œåˆå„ªæƒ å€å¡Š",
  "class": "section-cart-combined",
  "tag": "section",
  "settings": [
    {
      "type": "header",
      "content": "æ¢ä»¶å„ªæƒ è¨­å®š"
    },

    {
      "type": "text",
      "id": "progress_title",
      "label": "é€²åº¦æ¢æ¨™é¡Œ",
      "default": "è·é›¢å…é‹è²»é‚„å·®"
    },
    {
      "type": "textarea",
      "id": "initial_message",
      "label": "åˆå§‹è¨Šæ¯",
      "default": "é–‹å§‹è³¼ç‰©å³å¯äº«å—å„ªæƒ ï¼",
      "info": "ç•¶æ²’æœ‰å„ªæƒ éšå±¤æ™‚é¡¯ç¤ºçš„è¨Šæ¯"
    },
    {
      "type": "header",
      "content": "æ¨è–¦å•†å“è¨­å®š"
    },
    {
      "type": "text",
      "id": "upsell_title",
      "label": "æ¨è–¦å•†å“æ¨™é¡Œ",
      "default": "æ¨è–¦åŠ è³¼å•†å“"
    },
    {
      "type": "product_list",
      "id": "product_list",
      "label": "é¸æ“‡æ¨è–¦å•†å“",
      "limit": 8
    },
    {
      "type": "range",
      "id": "max_products",
      "label": "æœ€å¤šé¡¯ç¤ºå•†å“æ•¸",
      "min": 3,
      "max": 8,
      "step": 1,
      "default": 6
    },
    {
      "type": "checkbox",
      "id": "show_prices",
      "label": "é¡¯ç¤ºåƒ¹æ ¼",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "enable_quick_add",
      "label": "å•Ÿç”¨å¿«é€ŸåŠ å…¥è³¼ç‰©è»Š",
      "default": true
    },
    {
      "type": "header",
      "content": "é¡¯ç¤ºè¨­å®š"
    },

    {
      "type": "checkbox",
      "id": "hide_progress",
      "label": "éš±è—é€²åº¦æ¢",
      "default": false,
      "info": "åªé¡¯ç¤ºå„ªæƒ è¨Šæ¯ï¼Œä¸é¡¯ç¤ºé€²åº¦æ¢"
    },
    {
      "type": "checkbox",
      "id": "hide_conditional",
      "label": "éš±è—æ¢ä»¶å„ªæƒ å€åŸŸ",
      "default": false,
      "info": "å®Œå…¨éš±è—æ¢ä»¶å¼å„ªæƒ åŠŸèƒ½"
    },
    {
      "type": "checkbox",
      "id": "hide_upsell",
      "label": "éš±è—æ¨è–¦å•†å“å€åŸŸ",
      "default": false,
      "info": "å®Œå…¨éš±è—æ¨è–¦å•†å“åŠŸèƒ½"
    },
    {
      "type": "header",
      "content": "é¡è‰²è¨­å®š"
    },
    {
      "type": "color",
      "id": "loading_bg_color",
      "label": "è¼‰å…¥èƒŒæ™¯è‰²",
      "default": "#1a1a1a",
      "info": "é˜²æ­¢è¼‰å…¥æ™‚ç™½è‰²é–ƒçˆçš„é è¨­èƒŒæ™¯è‰²"
    },
    {
      "type": "checkbox",
      "id": "use_accent_gradient",
      "label": "ä½¿ç”¨å¼·èª¿è‰²æ¼¸è®Š",
      "default": true
    },
    {
      "type": "color",
      "id": "accent_color_start",
      "label": "å¼·èª¿è‰²ï¼ˆèµ·å§‹ï¼‰",
      "default": "#ff6b35"
    },
    {
      "type": "color",
      "id": "accent_color_end",
      "label": "å¼·èª¿è‰²ï¼ˆçµæŸï¼‰",
      "default": "#f7931e"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "ä¸»è¦æ–‡å­—é¡è‰²",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "text_secondary_color",
      "label": "æ¬¡è¦æ–‡å­—é¡è‰²",
      "default": "#cccccc"
          }
    ],
    "blocks": [
      {
        "type": "tier",
        "name": "å„ªæƒ éšå±¤",
        "settings": [
          {
            "type": "number",
            "id": "amount",
            "label": "ç›®æ¨™é‡‘é¡",
            "default": 1000,
            "info": "é”åˆ°æ­¤é‡‘é¡å³å¯äº«å—å„ªæƒ "
          },
          {
            "type": "text",
            "id": "benefit",
            "label": "å„ªæƒ å…§å®¹",
            "default": "å…é‹è²»",
            "info": "ä¾‹å¦‚ï¼šå…é‹è²»ã€NT$ 100 æŠ˜æ‰£ç­‰"
          },
          {
            "type": "textarea",
            "id": "description",
            "label": "è©³ç´°èªªæ˜",
            "info": "å¯é¸çš„è©³ç´°èªªæ˜æ–‡å­—"
          }
        ]
      }
    ],
    "presets": [
      {
        "name": "è³¼ç‰©è»Šç¶œåˆå„ªæƒ ",
        "category": "éŠ·å”®åŠŸèƒ½",
        "blocks": [
          {
            "type": "tier",
            "settings": {
              "amount": 1000,
              "benefit": "å…é‹è²»"
            }
          },
          {
            "type": "tier",
            "settings": {
              "amount": 1500,
              "benefit": "NT$ 100 æŠ˜æ‰£"
            }
          },
          {
            "type": "tier",
            "settings": {
              "amount": 2000,
              "benefit": "NT$ 200 æŠ˜æ‰£"
            }
          }
        ]
      }
    ]
  }
  {% endschema %}
