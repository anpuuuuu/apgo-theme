{% comment %}
Section: checkout-prefill-apgo.liquid
Purpose: APGO é¢¨æ ¼çš„è³¼ç‰©è»Šé é¢ã€Œå®…é…ï¼è¶…å•†ã€é‹é€æ–¹å¼åœ°å€æ”¶é›† UI
Style: é»‘æ©˜ä¸»é¡Œï¼Œæ‰‹æ©Ÿå„ªå…ˆè¨­è¨ˆ
Version: 1.0.0
{% endcomment %}

<section id="checkout-prefill" class="apgo-checkout-section">
  <div class="apgo-checkout-container">
    <!-- é ‚éƒ¨æ©˜è‰²å¼·èª¿ç·š -->
    <div class="apgo-top-accent"></div>
    
    <div class="apgo-checkout-card">
      <div class="apgo-checkout-header">
        <h3 class="apgo-checkout-title">{{ section.settings.title }}</h3>
        <p class="apgo-checkout-subtitle">{{ section.settings.subtitle }}</p>
      </div>

      <!-- é‹é€æ–¹å¼åˆ‡æ› -->
      <div class="apgo-shipping-toggle">
        {% if section.settings.enable_home and section.settings.enable_cvs %}
        <label class="apgo-radio-option" data-method="home">
          <input type="radio" name="cp-method" value="home" checked>
          <span class="apgo-radio-button">
            <svg class="apgo-radio-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
              <polyline points="9 22 9 12 15 12 15 22"/>
            </svg>
            <span class="apgo-radio-label">å®…é…åˆ°åºœ</span>
          </span>
        </label>
        <label class="apgo-radio-option" data-method="cvs">
          <input type="radio" name="cp-method" value="cvs">
          <span class="apgo-radio-button">
            <svg class="apgo-radio-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path d="M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1"/>
              <path d="M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4"/>
            </svg>
            <span class="apgo-radio-label">è¶…å•†å–è²¨</span>
          </span>
        </label>
        {% elsif section.settings.enable_home %}
          <input type="hidden" name="cp-method" value="home">
        {% elsif section.settings.enable_cvs %}
          <input type="hidden" name="cp-method" value="cvs">
        {% endif %}
      </div>

      <!-- è¡¨å–®å€åŸŸ -->
      <div class="apgo-form-container">
        <!-- å…±ç”¨æ¬„ä½ï¼šå§“åã€é›»è©± -->
        <div class="apgo-form-group">
          <label class="apgo-label">
            æ”¶ä»¶äººå§“å <span class="apgo-required">*</span>
          </label>
          <input id="cp-name" type="text" class="apgo-input" placeholder="ä¾‹ï¼šç‹å°æ˜" maxlength="30">
        </div>
        
        <div class="apgo-form-group">
          <label class="apgo-label">
            è¯çµ¡é›»è©± <span class="apgo-required">*</span>
          </label>
          <input id="cp-phone" type="tel" class="apgo-input" inputmode="tel" placeholder="ä¾‹ï¼š0912345678">
        </div>

        <!-- å®…é…è¡¨å–® -->
        {% if section.settings.enable_home %}
        <div id="cp-home" class="apgo-shipping-pane">
          <div class="apgo-notice">
            <svg class="apgo-notice-icon" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z"/>
            </svg>
            <span>è«‹å¡«å¯«å®Œæ•´åœ°å€ä»¥ä¾¿å¯„é€</span>
          </div>
          
          <div class="apgo-form-row">
            <div class="apgo-form-group">
              <label class="apgo-label">
                ç¸£å¸‚ <span class="apgo-required">*</span>
              </label>
              <select id="cp-home-county" class="apgo-select">
                <option value="">è«‹é¸æ“‡</option>
                <option>è‡ºåŒ—å¸‚</option><option>æ–°åŒ—å¸‚</option><option>åŸºéš†å¸‚</option><option>æ¡ƒåœ’å¸‚</option>
                <option>æ–°ç«¹å¸‚</option><option>æ–°ç«¹ç¸£</option><option>è‹—æ —ç¸£</option><option>è‡ºä¸­å¸‚</option>
                <option>å½°åŒ–ç¸£</option><option>å—æŠ•ç¸£</option><option>é›²æ—ç¸£</option><option>å˜‰ç¾©å¸‚</option>
                <option>å˜‰ç¾©ç¸£</option><option>è‡ºå—å¸‚</option><option>é«˜é›„å¸‚</option><option>å±æ±ç¸£</option>
                <option>å®œè˜­ç¸£</option><option>èŠ±è“®ç¸£</option><option>è‡ºæ±ç¸£</option><option>æ¾æ¹–ç¸£</option>
                <option>é‡‘é–€ç¸£</option><option>é€£æ±Ÿç¸£</option>
              </select>
            </div>
            
                         <div class="apgo-form-group">
               <label class="apgo-label">
                 é„‰é®å¸‚å€ <span class="apgo-required">*</span>
               </label>
               <select id="cp-home-district" class="apgo-select" disabled>
                 <option value="">è«‹å…ˆé¸ç¸£å¸‚</option>
               </select>
               <!-- â˜… éƒµéå€è™Ÿæç¤ºï¼ˆå®…é…ï¼‰ -->
               <div id="cp-home-zip-hint" class="apgo-zip-hint" data-empty="true">
                 éƒµéå€è™Ÿï¼š<span id="cp-home-zip-text">â€”</span>
               </div>
             </div>
          </div>
          
          
          
          <div class="apgo-form-group">
            <label class="apgo-label">
              è©³ç´°åœ°å€ <span class="apgo-required">*</span>
            </label>
            <input id="cp-home-address1" type="text" class="apgo-input" placeholder="ä¾‹ï¼šå¿ å­æ±è·¯å››æ®µ 100 è™Ÿ 5 æ¨“">
          </div>
        </div>
        {% endif %}

        <!-- è¶…å•†è¡¨å–® -->
        {% if section.settings.enable_cvs %}
        <div id="cp-cvs" class="apgo-shipping-pane" {% if section.settings.enable_home %}style="display:none"{% endif %}>
          <div class="apgo-notice">
            <svg class="apgo-notice-icon" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z"/>
            </svg>
            <span>é¸æ“‡å€åŸŸå¾Œå°‡åœ¨çµå¸³é é¢é¡¯ç¤ºé™„è¿‘è¶…å•†</span>
          </div>
          
          <div class="apgo-form-row">
            <div class="apgo-form-group">
              <label class="apgo-label">
                ç¸£å¸‚ <span class="apgo-required">*</span>
              </label>
              <select id="cp-cvs-county" class="apgo-select">
                <option value="">è«‹é¸æ“‡</option>
                <option>è‡ºåŒ—å¸‚</option><option>æ–°åŒ—å¸‚</option><option>åŸºéš†å¸‚</option><option>æ¡ƒåœ’å¸‚</option>
                <option>æ–°ç«¹å¸‚</option><option>æ–°ç«¹ç¸£</option><option>è‹—æ —ç¸£</option><option>è‡ºä¸­å¸‚</option>
                <option>å½°åŒ–ç¸£</option><option>å—æŠ•ç¸£</option><option>é›²æ—ç¸£</option><option>å˜‰ç¾©å¸‚</option>
                <option>å˜‰ç¾©ç¸£</option><option>è‡ºå—å¸‚</option><option>é«˜é›„å¸‚</option><option>å±æ±ç¸£</option>
                <option>å®œè˜­ç¸£</option><option>èŠ±è“®ç¸£</option><option>è‡ºæ±ç¸£</option><option>æ¾æ¹–ç¸£</option>
                <option>é‡‘é–€ç¸£</option><option>é€£æ±Ÿç¸£</option>
              </select>
            </div>
            
                         <div class="apgo-form-group">
               <label class="apgo-label">
                 é„‰é®å¸‚å€ <span class="apgo-required">*</span>
               </label>
               <select id="cp-cvs-district" class="apgo-select" disabled>
                 <option value="">è«‹å…ˆé¸ç¸£å¸‚</option>
               </select>
               <!-- â˜… éƒµéå€è™Ÿæç¤ºï¼ˆè¶…å•†ï¼‰ -->
               <div id="cp-cvs-zip-hint" class="apgo-zip-hint" data-empty="true">
                 éƒµéå€è™Ÿï¼š<span id="cp-cvs-zip-text">â€”</span>
               </div>
             </div>
          </div>
          
          {% if section.settings.enable_road_dropdown %}
          <div class="apgo-form-group">
            <label class="apgo-label">
              è·¯å <span class="apgo-required">*</span>
            </label>
            <select id="cp-cvs-road" class="apgo-select" disabled>
              <option value="">è«‹å…ˆé¸å€</option>
            </select>
          </div>
          {% else %}
          <div class="apgo-form-group">
            <label class="apgo-label">
              è·¯åï¼ˆå¯å«æ®µï¼‰ <span class="apgo-required">*</span>
            </label>
            <input id="cp-cvs-road-input" type="text" class="apgo-input" placeholder="ä¾‹ï¼šå¿ å­æ±è·¯å››æ®µ">
          </div>
          {% endif %}
          
          {% if section.settings.enable_detail_address %}
          <div class="apgo-form-group">
            <label class="apgo-label">è©³ç´°åœ°å€ <span class="apgo-optional">é¸å¡«</span></label>
            <input id="cp-cvs-address1-extra" type="text" class="apgo-input" placeholder="ä¾‹ï¼š100 è™Ÿ">
          </div>
          {% endif %}
        </div>
        {% endif %}
      </div>

      <!-- è¨Šæ¯é¡¯ç¤ºå€ -->
      <div class="apgo-actions">
        <div id="cp-msg" class="apgo-message" aria-live="polite"></div>
      </div>
    </div>
  </div>
</section>

<style>
/* APGO ä¸»é¡Œè®Šæ•¸ */
:root {
  --apgo-primary: #f08418;
  --apgo-primary-hover: #ff9a3c;
  --apgo-dark-bg: #000000;
  --apgo-card-bg: #1a1a1a;
  --apgo-card-hover: #2d2d2d;
  --apgo-border: #333333;
  --apgo-text-white: #ffffff;
  --apgo-text-gray: #cccccc;
  --apgo-text-light: #b0b0b0;
  --apgo-success: #4caf50;
  --apgo-error: #ef4444;
  --apgo-radius: 16px;
  --apgo-radius-sm: 12px;
}

/* ä¸»å®¹å™¨ - æ‰‹æ©Ÿå„ªå…ˆ */
.apgo-checkout-section {
  width: 100%;
  padding: 20px 16px;
  background: var(--apgo-dark-bg);
}

.apgo-checkout-container {
  max-width: 600px;
  margin: 0 auto;
  position: relative;
}

/* é ‚éƒ¨æ©˜è‰²å¼·èª¿ç·š */
.apgo-top-accent {
  position: absolute;
  top: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 85%;
  height: 4px;
  background: linear-gradient(90deg, var(--apgo-primary), var(--apgo-primary-hover));
  border-radius: var(--apgo-radius);
  z-index: 2;
}

/* å¡ç‰‡å®¹å™¨ */
.apgo-checkout-card {
  background: linear-gradient(145deg, var(--apgo-card-bg), var(--apgo-card-hover));
  border-radius: var(--apgo-radius);
  border: 1px solid var(--apgo-border);
  box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5),
              inset 0 1px 0 rgba(255, 255, 255, 0.1);
  padding: 24px 20px;
  margin-top: 8px;
}

/* æ¨™é¡Œå€ */
.apgo-checkout-header {
  text-align: center;
  margin-bottom: 24px;
}

.apgo-checkout-title {
  font-size: 1.5rem;
  font-weight: bold;
  color: var(--apgo-primary);
  margin: 0 0 8px 0;
  background: linear-gradient(45deg, var(--apgo-primary), var(--apgo-primary-hover));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.apgo-checkout-subtitle {
  font-size: 0.9rem;
  color: var(--apgo-text-gray);
  margin: 0;
  line-height: 1.4;
}

/* é‹é€æ–¹å¼åˆ‡æ›æŒ‰éˆ• */
.apgo-shipping-toggle {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
  margin-bottom: 24px;
}

.apgo-radio-option {
  position: relative;
  cursor: pointer;
}

.apgo-radio-option input {
  position: absolute;
  opacity: 0;
  pointer-events: none;
}

.apgo-radio-button {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 8px;
  padding: 16px 12px;
  background: rgba(255, 255, 255, 0.03);
  border: 2px solid var(--apgo-border);
  border-radius: var(--apgo-radius-sm);
  transition: all 0.3s ease;
}

.apgo-radio-icon {
  width: 24px;
  height: 24px;
  color: var(--apgo-text-gray);
  transition: all 0.3s ease;
}

.apgo-radio-label {
  font-size: 0.9rem;
  color: var(--apgo-text-gray);
  font-weight: 600;
  transition: all 0.3s ease;
}

.apgo-radio-option input:checked ~ .apgo-radio-button {
  background: rgba(240, 132, 24, 0.1);
  border-color: var(--apgo-primary);
  box-shadow: 0 4px 12px rgba(240, 132, 24, 0.2);
}

.apgo-radio-option input:checked ~ .apgo-radio-button .apgo-radio-icon {
  color: var(--apgo-primary);
}

.apgo-radio-option input:checked ~ .apgo-radio-button .apgo-radio-label {
  color: var(--apgo-primary);
}

/* è¡¨å–®æ¨£å¼ */
.apgo-form-container {
  margin-bottom: 24px;
}

.apgo-form-group {
  margin-bottom: 16px;
}

.apgo-form-row {
  display: grid;
  grid-template-columns: 1fr;
  gap: 16px;
  margin-bottom: 16px;
}

.apgo-label {
  display: block;
  font-size: 0.9rem;
  color: var(--apgo-text-white);
  margin-bottom: 8px;
  font-weight: 500;
}

.apgo-required {
  color: var(--apgo-primary);
  font-weight: bold;
}

.apgo-optional {
  color: var(--apgo-text-light);
  font-size: 0.8rem;
}

/* è¼¸å…¥æ¡†æ¨£å¼ */
.apgo-input,
.apgo-select {
  width: 100%;
  padding: 12px 16px;
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid var(--apgo-border);
  border-radius: var(--apgo-radius-sm);
  color: var(--apgo-text-white);
  font-size: 1rem;
  transition: all 0.3s ease;
  -webkit-appearance: none;
  appearance: none;
}

.apgo-select {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23cccccc' d='M10.293 3.293L6 7.586 1.707 3.293A1 1 0 00.293 4.707l5 5a1 1 0 001.414 0l5-5a1 1 0 10-1.414-1.414z'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 16px center;
  padding-right: 40px;
}

.apgo-input:hover,
.apgo-select:hover {
  border-color: var(--apgo-primary);
  background: rgba(240, 132, 24, 0.03);
}

.apgo-input:focus,
.apgo-select:focus {
  outline: none;
  border-color: var(--apgo-primary);
  background: rgba(240, 132, 24, 0.05);
  box-shadow: 0 0 0 3px rgba(240, 132, 24, 0.1);
}

.apgo-input::placeholder {
  color: var(--apgo-text-light);
  opacity: 0.7;
}

.apgo-select:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  background: rgba(255, 255, 255, 0.02);
  border-color: var(--apgo-border);
}

/* æç¤ºè¨Šæ¯ */
.apgo-notice {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 12px 16px;
  background: rgba(240, 132, 24, 0.1);
  border: 1px solid rgba(240, 132, 24, 0.3);
  border-radius: var(--apgo-radius-sm);
  margin-bottom: 20px;
  font-size: 0.85rem;
  color: var(--apgo-text-gray);
}

.apgo-notice-icon {
  width: 20px;
  height: 20px;
  color: var(--apgo-primary);
  flex-shrink: 0;
}

/* è¨Šæ¯é¡¯ç¤ºå€ */
.apgo-actions {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

/* è¨Šæ¯é¡¯ç¤º */
.apgo-message {
  text-align: center;
  font-size: 0.85rem;
  color: var(--apgo-text-gray);
  min-height: 20px;
}

.apgo-message.error {
  color: var(--apgo-error);
  font-weight: 500;
}

.apgo-message.success {
  color: var(--apgo-success);
  font-weight: 500;
}

/* è¼‰å…¥å‹•ç•« */
@keyframes apgo-spin {
  to { transform: rotate(360deg); }
}

.apgo-loading {
  display: inline-block;
  width: 16px;
  height: 16px;
  border: 2px solid var(--apgo-border);
  border-top-color: var(--apgo-primary);
  border-radius: 50%;
  animation: apgo-spin 0.8s linear infinite;
}

/* å¹³æ¿éŸ¿æ‡‰å¼ */
@media (min-width: 768px) {
  .apgo-checkout-section {
    padding: 40px 20px;
  }
  
  .apgo-checkout-container {
    max-width: 700px;
  }
  
  .apgo-checkout-card {
    padding: 32px 28px;
  }
  
  .apgo-checkout-title {
    font-size: 1.8rem;
  }
  
  .apgo-checkout-subtitle {
    font-size: 1rem;
  }
  
  .apgo-form-row {
    grid-template-columns: 1fr 1fr;
  }
  
  .apgo-shipping-toggle {
    max-width: 400px;
    margin: 0 auto 28px;
  }
}

/* æ¡Œé¢éŸ¿æ‡‰å¼ */
@media (min-width: 1024px) {
  .apgo-checkout-section {
    padding: 60px 20px;
  }
  
  .apgo-checkout-container {
    max-width: 800px;
  }
  
  .apgo-checkout-card {
    padding: 40px 36px;
  }
  
  .apgo-checkout-title {
    font-size: 2rem;
  }
  
  .apgo-input,
  .apgo-select {
    padding: 14px 18px;
  }
  
  .apgo-actions {
    align-items: center;
  }
}

/* å‹•ç•«æ•ˆæœ */
@keyframes apgo-fadeInUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.apgo-checkout-card {
  animation: apgo-fadeInUp 0.6s ease-out;
}

.apgo-shipping-pane {
  animation: apgo-fadeInUp 0.4s ease-out;
}

  /* â˜… éƒµéå€è™Ÿå°æç¤ºï¼ˆè²¼åœ¨ä¸‹æ‹‰ä¸‹æ–¹ï¼‰ */
  .apgo-zip-hint{
    margin-top: 6px;
    font-size: 0.8rem;
    line-height: 1.2;
    color: var(--apgo-text-light);
  }
  .apgo-zip-hint span{ font-weight: 700; color: var(--apgo-text-white); }
  .apgo-zip-hint[data-empty="true"] span{ opacity:.6; }
</style>

  <script>
(function(){
  const s = {{ section.settings | json }};
  const el = (id) => document.getElementById(id);
  const q = (sel, root) => (root || document).querySelector(sel);
  const msg = el('cp-msg');

  // å…ƒç´ å¼•ç”¨
  const nameEl = el('cp-name');
  const phoneEl = el('cp-phone');

  // === å³æ™‚åŒæ­¥åˆ°ç¶²å€ queryï¼šcheckout é å¡« & attributes ===
  const qp = new URLSearchParams(location.search);

  // å°‡ç›®å‰æ¬„ä½å€¼ â†’ è½‰æˆ Shopify checkout é å¡«åƒæ•¸ + attributes
  function buildCheckoutParams({previewOnly=false} = {}) {
    const method = document.querySelector('input[name="cp-method"]:checked')?.value || (s.enable_home ? 'home' : 'cvs');
    const fullName = (nameEl?.value || '').trim();
    const phone = normPhone(phoneEl?.value || '');
    const { first: first_name, last: last_name } = splitName(fullName);

    // å…±ç”¨ï¼šå§“åã€é›»è©±
    setQP(`checkout[shipping_address][first_name]`, first_name);
    setQP(`checkout[shipping_address][last_name]`,  last_name);
    setQP(`checkout[shipping_address][phone]`,      phone);
    setQP(`checkout[shipping_address][country]`,    s.country || 'Taiwan');

    // ä¾é‹é€æ–¹å¼çµ„åœ°å€
    if (method === 'home') {
      const c = homeCounty?.value || '';      // ç¸£å¸‚ï¼ˆä¾‹ï¼šè‡ºåŒ—å¸‚ï¼‰
      const d = homeDistrict?.value || '';    // å€ï¼ˆä¾‹ï¼šå¤§å®‰å€ï¼‰
      const a1 = el('cp-home-address1')?.value?.trim() || '';
      // â˜… å–è‡ªå‹•åµæ¸¬ zipï¼ˆè‹¥åµæ¸¬ä¸åˆ°å°±ä¸å¸¶ï¼‰
      const zFinal = detectedZipHome || '';

      // âœ… city åªæ”¾ç¸£å¸‚ï¼›address1 å‰é¢åŠ ä¸Šå€
      const cityOnly = c;
      const address1 = (d ? (d + ' ') : '') + a1;

      setQP(`checkout[shipping_address][city]`,      cityOnly);
      setQP(`checkout[shipping_address][province]`,  cityOnly); // å…¼å®¹æ€§åŠ å¼·ï¼ˆå¯ä¿ç•™ï¼‰
      setQP(`checkout[shipping_address][address1]`,  address1);
      if (zFinal) setQP(`checkout[shipping_address][zip]`, zFinal);
      else delQP(`checkout[shipping_address][zip]`);

      if (s.enable_attr) {
        setQP(`attributes[é‹é€æ–¹å¼]`, 'å®…é…');
        setQP(`attributes[ç¸£å¸‚]`, c);
        setQP(`attributes[é„‰é®å¸‚å€]`, d);
        setQP(`attributes[åœ°å€_address1]`, a1);
        setQP(`attributes[å§“å]`, fullName);
        setQP(`attributes[é›»è©±]`, phone);
        if (zFinal) setQP(`attributes[åœ°å€_zip]`, zFinal); else delQP(`attributes[åœ°å€_zip]`);
        // ç§»é™¤èˆŠçš„åˆä½µæ¬„ä½ï¼ˆè‹¥æ›¾å­˜åœ¨ï¼‰
        delQP(`attributes[åœ°å€_city]`);
      }
    } else {
      const c = cvsCounty?.value || '';
      const d = cvsDistrict?.value || '';
      const road = (el('cp-cvs-road') ? (el('cp-cvs-road').value || '') : (el('cp-cvs-road-input')?.value?.trim() || ''));
      const extra = el('cp-cvs-address1-extra')?.value?.trim() || '';

      // âœ… city=ç¸£å¸‚ï¼›address1=ã€Œå€ + è·¯å +ï¼ˆé–€ç‰Œï¼‰ã€ï¼›ä¸å¸¶ zip
      const cityOnly = c;
      const address1 = (d ? (d + ' ') : '') + (road ? road : '') + (extra ? (' ' + extra) : '');

              setQP(`checkout[shipping_address][city]`,      cityOnly);
        setQP(`checkout[shipping_address][province]`,  cityOnly); // å…¼å®¹æ€§åŠ å¼·ï¼ˆå¯ä¿ç•™ï¼‰
        setQP(`checkout[shipping_address][address1]`,  address1);
        
        // â˜… è¶…å•†ä¹Ÿå¸¶å…¥éƒµéå€è™Ÿï¼ˆShopify è¦å®šï¼‰
        const cvsZip = getZipByCityDistrict(addressData || [], c, d);
        if (cvsZip) setQP(`checkout[shipping_address][zip]`, cvsZip);
        else delQP(`checkout[shipping_address][zip]`);

        if (s.enable_attr) {
          setQP(`attributes[é‹é€æ–¹å¼]`, 'è¶…å•†');
          setQP(`attributes[ç¸£å¸‚]`, c);
          setQP(`attributes[é„‰é®å¸‚å€]`, d);
          setQP(`attributes[åœ°å€_è·¯å]`, road);
          setQP(`attributes[åœ°å€_address1]`, (road + (extra ? (' ' + extra) : '')));
          setQP(`attributes[å§“å]`, fullName);
          setQP(`attributes[é›»è©±]`, phone);
          if (cvsZip) setQP(`attributes[åœ°å€_zip]`, cvsZip); else delQP(`attributes[åœ°å€_zip]`);
          delQP(`attributes[åœ°å€_city]`);
        }
    }

    // æ²’å€¼çš„ key å°±å¾ç¶²å€å‰”é™¤ï¼ˆé¿å…é«’åƒæ•¸ï¼‰
    cleanEmptyParams();

    // é è¦½æ¨¡å¼åƒ…å›å‚³ï¼Œä¸å¯«ç¶²å€
    if (previewOnly) return new URLSearchParams(qp);

    // å¯«å›ç•¶å‰ç¶²å€ï¼ˆä¸é‡æ•´ï¼‰
    history.replaceState(null, '', `${location.pathname}?${qp.toString()}`);
  }

  // å·¥å…·ï¼šè¨­/åˆª query åƒæ•¸ï¼ˆæ”¯æ´é™£åˆ—é¢¨æ ¼ keyï¼‰
  function setQP(key, val) {
    if (val == null) return;
    const v = String(val).trim();
    if (v) { qp.set(key, v); }
    else { qp.delete(key); }
  }
  function delQP(key) { qp.delete(key); }

  function cleanEmptyParams() {
    // ç§»é™¤ç©ºå€¼ã€undefinedã€null
    [...qp.keys()].forEach(k => {
      const v = qp.get(k);
      if (v == null || v === 'null' || v === 'undefined' || v.trim() === '') qp.delete(k);
    });
  }

  // å°‡æ¯å€‹æ¬„ä½è®Šæ›´ â†’ ç«‹å³åŒæ­¥åˆ°ç¶²å€
  function wireLiveSync() {
    const ids = [
      'cp-name','cp-phone','cp-home-address1',
      'cp-home-county','cp-home-district',
      'cp-cvs-county','cp-cvs-district','cp-cvs-road','cp-cvs-road-input','cp-cvs-address1-extra'
    ];
          ids.forEach(id => {
        const e = el(id);
        if (!e) return;
        const evt = (e.tagName === 'INPUT') ? 'input' : 'change';
        e.addEventListener(evt, () => {
          buildCheckoutParams();
          // â˜… å®…é…æ¬„ä½è®Šæ›´æ™‚é †ä¾¿åµæ¸¬ zip
          if (id === 'cp-home-county' || id === 'cp-home-district' || id === 'cp-home-address1') {
            updateZipHomeDisplay();
          }
          // è¶…å•†æ¬„ä½è®Šæ›´æ™‚æ›´æ–° zip æç¤º
          if (id === 'cp-cvs-county' || id === 'cp-cvs-district') {
            updateZipCvsDisplay();
          }
        });
      });

    // é‹é€æ–¹å¼åˆ‡æ›ä¹Ÿå³æ™‚åŒæ­¥
    document.querySelectorAll('input[name="cp-method"]').forEach(r => {
      r.addEventListener('change', () => {
        buildCheckoutParams();
        const v = document.querySelector('input[name="cp-method"]:checked')?.value;
        if (v === 'home') updateZipHomeDisplay();
      });
    });
  }

  // é¢æ¿åˆ‡æ›ï¼ˆå®…é…/è¶…å•†ï¼‰
  document.querySelectorAll('input[name="cp-method"]').forEach(r => {
    r.addEventListener('change', () => {
      const v = document.querySelector('input[name="cp-method"]:checked')?.value;
      togglePane(v);
    });
  });

  function togglePane(v) {
    const home = el('cp-home');
    const cvs = el('cp-cvs');
    if (home) home.style.display = (v === 'home') ? '' : 'none';
    if (cvs) cvs.style.display = (v === 'cvs') ? '' : 'none';
  }

  // åˆå§‹åŒ–é è¨­å€¼
  (function() {
    const checked = document.querySelector('input[name="cp-method"]:checked');
    if (checked) togglePane(checked.value);
  })();

  // OpenSheet API
  const OPENSHEET_URL = 'https://opensheet.elk.sh/1S81a-nrJR1yzmEnWVjuGJuiiW1S2UWP2VpGaxmBuoJ4/taiwan_road';
  let addressData = null; // å¿«å–è³‡æ–™
  let detectedZipHome = ''; // â˜… æ–°å¢ï¼šåµæ¸¬åˆ°çš„å®…é…éƒµéå€è™Ÿ
  
  // è¼‰å…¥å®Œæ•´åœ°å€è³‡æ–™ï¼ˆåªè¼‰å…¥ä¸€æ¬¡ï¼‰
  async function loadAddressData() {
    if (addressData) {
      console.log('ä½¿ç”¨å¿«å–è³‡æ–™');
      return addressData;
    }
    
    try {
      console.log('é–‹å§‹è¼‰å…¥ OpenSheet è³‡æ–™...');
      showLoading('è¼‰å…¥åœ°å€è³‡æ–™ä¸­...');
      
      const response = await fetch(OPENSHEET_URL);
      console.log('API å›æ‡‰ç‹€æ…‹:', response.status);
      
      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
      }
      
      const data = await response.json();
      console.log('æˆåŠŸè¼‰å…¥è³‡æ–™ï¼Œå…±', data.length, 'ç­†');
      
      // æª¢æŸ¥è³‡æ–™çµæ§‹
      if (data.length > 0) {
        console.log('è³‡æ–™æ¬„ä½:', Object.keys(data[0]));
        console.log('ç¬¬ä¸€ç­†è³‡æ–™ç¯„ä¾‹:', data[0]);
      }
      
      addressData = data;
      hideMessage();
      return data;
    } catch (error) {
      console.error('è¼‰å…¥åœ°å€è³‡æ–™å¤±æ•—:', error);
      showError('åœ°å€è³‡æ–™è¼‰å…¥å¤±æ•—ï¼Œè«‹é‡æ–°æ•´ç†é é¢');
      return [];
    }
  }
  
  // å–å¾—ä¸é‡è¤‡çš„ç¸£å¸‚åˆ—è¡¨
  function getUniqueCounties(data) {
    const counties = [...new Set(data.map(item => item['city']))];
    return counties.filter(c => c).sort();
  }
  
  // å–å¾—æŒ‡å®šç¸£å¸‚çš„å€åŸŸåˆ—è¡¨
  function getDistricts(data, county) {
    const c = canonicalCounty(county);
    const filtered = data.filter(item => canonicalCounty(item['city']) === c);
    const districts = [...new Set(filtered.map(item => canonicalDistrict(item['district'])))];
    return districts.filter(Boolean).sort();
  }
  
  // å–å¾—æŒ‡å®šç¸£å¸‚+å€åŸŸçš„è·¯ååˆ—è¡¨
  function getRoads(data, county, district) {
    const c = canonicalCounty(county);
    const d = canonicalDistrict(district);
    const filtered = data.filter(item =>
      canonicalCounty(item['city']) === c && canonicalDistrict(item['district']) === d
    );
    const roads = [...new Set(filtered.map(item => item['road']))];
    return roads.filter(Boolean).sort();
  }
  
  function fillSelect(select, list, placeholder) {
    select.innerHTML = '';
    const ph = document.createElement('option');
    ph.value = '';
    ph.textContent = placeholder || 'è«‹é¸æ“‡';
    select.appendChild(ph);
    list.forEach(v => {
      const o = document.createElement('option');
      o.value = v;
      o.textContent = v;
      select.appendChild(o);
    });
    select.disabled = list.length === 0;
  }

  // â˜… æ–°å¢ï¼šå¾ taiwan_road ç›´æ¥æ¨ç®— zipï¼ˆä»¥ã€Œç¸£å¸‚+è¡Œæ”¿å€ã€ç‚ºä¸»ï¼Œè‹¥æ¯åˆ—çš†æœ‰åŒä¸€ zipï¼Œå–å…¶ä¸€ï¼‰
  function getZipByCityDistrict(data, county, district) {
    if (!data || !data.length) return '';
    const c = canonicalCounty(county);
    const d = canonicalDistrict(district);
    // ç¯©å‡ºè©²ç¸£å¸‚+å€çš„æ‰€æœ‰åˆ—
    const rows = data.filter(item =>
      canonicalCounty(item['city']) === c && canonicalDistrict(item['district']) === d
    );
    if (!rows.length) return '';
    // å„ªå…ˆå–è©²é›†åˆä¸­å”¯ä¸€çš„ zipï¼›å¦‚æœæœ‰å¤šå€‹ä¸åŒ zipï¼Œå°±å…ˆå–ç¬¬ä¸€å€‹ï¼ˆå¤šåŠå°ç£åŒå€åŒä¸€ zipï¼‰
    const zset = [...new Set(rows.map(r => (r.zip || r.ZIP || r['éƒµéå€è™Ÿ'] || '').toString().trim()).filter(Boolean))];
    return zset[0] || '';
  }

  // æ›´æ–° UI èˆ‡å…§éƒ¨ç‹€æ…‹
  async function updateZipHomeDisplay() {
    const city = el('cp-home-county')?.value || '';
    const dist = el('cp-home-district')?.value || '';
    if (!city || !dist) {
      detectedZipHome = '';
      setZipHint('cp-home-zip-hint','cp-home-zip-text','');
      buildCheckoutParams(); // æ¸…é™¤ zip
      return;
    }
    const data = await loadAddressData();
    const z = getZipByCityDistrict(data, city, dist);
    detectedZipHome = z || '';
    setZipHint('cp-home-zip-hint','cp-home-zip-text', detectedZipHome);
    buildCheckoutParams(); // å®…é… zip æœƒå¸¶åˆ° checkout & attributes
  }

  // â˜… æ–°å¢ï¼šè¶…å•† zip é¡¯ç¤ºï¼ˆåªé¡¯ç¤ºï¼Œä¸å¸¶åƒæ•¸ï¼‰
  async function updateZipCvsDisplay() {
    const city = el('cp-cvs-county')?.value || '';
    const dist = el('cp-cvs-district')?.value || '';
    if (!city || !dist) {
      setZipHint('cp-cvs-zip-hint','cp-cvs-zip-text','');
      return;
    }
    const data = await loadAddressData();
    const z = getZipByCityDistrict(data, city, dist);
    setZipHint('cp-cvs-zip-hint','cp-cvs-zip-text', z || '');
  }

  // é é¢è¼‰å…¥æ™‚ç«‹å³è¼‰å…¥è³‡æ–™ä¸¦æª¢æŸ¥ç¸£å¸‚åç¨±
  window.addEventListener('DOMContentLoaded', async () => {
    console.log('é é¢è¼‰å…¥å®Œæˆï¼Œé–‹å§‹è¼‰å…¥åœ°å€è³‡æ–™...');
    const data = await loadAddressData();
    if (data && data.length > 0) {
      console.log('âœ… åœ°å€è³‡æ–™è¼‰å…¥æˆåŠŸ');
      
      // é¡¯ç¤ºå¯¦éš›çš„ç¸£å¸‚åˆ—è¡¨ä¾›å°ç…§
      const actualCounties = getUniqueCounties(data);
      console.log('ğŸ“ è³‡æ–™åº«ä¸­çš„ç¸£å¸‚åˆ—è¡¨:', actualCounties);
      console.log('ğŸ’¡ æç¤º: è«‹ç¢ºèªé¸å–®ä¸­çš„ç¸£å¸‚åç¨±èˆ‡è³‡æ–™åº«ä¸€è‡´');
      
      // æª¢æŸ¥ç¬¬ä¸€å€‹ç¸£å¸‚çš„è³‡æ–™ç¯„ä¾‹
      if (actualCounties.length > 0) {
        const sampleCity = actualCounties[0];
        const sampleDistricts = getDistricts(data, sampleCity);
        console.log(`ğŸ“‹ ${sampleCity} çš„å€åŸŸç¯„ä¾‹:`, sampleDistricts.slice(0, 5));
      }
      
      // â˜… æ–°å¢ï¼šæŠŠç¸£å¸‚é¸å–®ç”¨è³‡æ–™è¦†è“‹ï¼Œé¿å…å°/è‡ºä¸ä¸€è‡´
      try {
        const actualCounties = [...new Set(addressData.map(r => canonicalCounty(r.city)))].filter(Boolean).sort();
        if (homeCounty) fillSelect(homeCounty, actualCounties, 'è«‹é¸æ“‡');
        if (cvsCounty)  fillSelect(cvsCounty,  actualCounties, 'è«‹é¸æ“‡');
      } catch(e){ console.warn('è¦†è“‹ç¸£å¸‚é¸å–®å¤±æ•—', e); }
    } else {
      console.log('âš ï¸ åœ°å€è³‡æ–™ç‚ºç©ºæˆ–è¼‰å…¥å¤±æ•—');
    }

          // åˆå§‹ï¼šæŠŠç¾æœ‰ï¼ˆè‹¥æœ‰ï¼‰å€¼åŒæ­¥ä¸€æ¬¡åˆ°ç¶²å€
      wireLiveSync();
      buildCheckoutParams();
      updateZipHomeDisplay();
      updateZipCvsDisplay();

    // â˜… æ–°å¢ï¼šä¿®æ­£æ‰€æœ‰ã€Œå‰å¾€çµå¸³ã€å…¥å£ï¼Œç¢ºä¿å¸¶ä¸Š query
    patchCheckoutEntrances();

    function patchCheckoutEntrances(){
      // 1) <a href="/checkout">ï¼šé»æ“Šå‰å‹•æ…‹è£œä¸Šç›®å‰ query
      document.addEventListener('click', (ev) => {
        const a = ev.target.closest && ev.target.closest('a[href^="/checkout"]');
        if (!a) return;
        buildCheckoutParams(); // å…ˆæŠŠç•¶å‰æ¬„ä½åŒæ­¥åˆ°ç¶²å€
        a.setAttribute('href', '/checkout' + (location.search || ''));
      }, true);

      // 2) è¡¨å–®æäº¤é¡ï¼ˆå¤šæ•¸ä¸»é¡Œçš„çµå¸³æŒ‰éˆ•ï¼‰
      document.querySelectorAll('form').forEach(form => {
        const btn = form.querySelector('button[name="checkout"], input[name="checkout"]');
        if (!btn) return;

        // æ–¹æ¡ˆ Aï¼ˆæœ€ç©©ï¼‰ï¼šé˜»æ­¢é è¨­æäº¤ï¼Œæ”¹å°å‘ GET /checkout?...
        btn.addEventListener('click', (e) => {
          buildCheckoutParams();
          e.preventDefault();
          location.href = '/checkout' + (location.search || '');
        }, true);

        // æ–¹æ¡ˆ Bï¼ˆè¦ä¿ç•™ POST æ™‚ï¼Œæ”¹ actionï¼›è¨»è§£æ‰ä¸Šé¢ Aï¼‰
        // btn.addEventListener('click', () => {
        //   buildCheckoutParams();
        //   form.action = '/checkout' + (location.search || '');
        // }, true);
      });
    }
  });

  // è¼‰å…¥å€/è·¯ï¼šå®…é…
  const homeCounty = el('cp-home-county');
  const homeDistrict = el('cp-home-district');
  
  homeCounty?.addEventListener('change', async () => {
    console.log('å®…é…ç¸£å¸‚è®Šæ›´:', homeCounty.value);
    const c = homeCounty.value;
    
    if (!c) {
      fillSelect(homeDistrict, [], 'è«‹å…ˆé¸ç¸£å¸‚');
      return;
    }
    
    // ç¢ºä¿è³‡æ–™å·²è¼‰å…¥
    const data = await loadAddressData();
    console.log('è³‡æ–™è¼‰å…¥ç‹€æ…‹:', data ? `${data.length}ç­†` : 'ç„¡è³‡æ–™');
    
    if (data && data.length > 0) {
      const districts = getDistricts(data, c);
      console.log(`${c} çš„å€åŸŸ:`, districts);
      fillSelect(homeDistrict, districts, 'è«‹é¸æ“‡å€');
    } else {
      fillSelect(homeDistrict, [], 'ç„¡æ³•è¼‰å…¥å€');
      showError('ç„¡æ³•è¼‰å…¥å€åŸŸè³‡æ–™');
    }
    // ç›£è½çµå°¾åŠ ï¼š
    updateZipHomeDisplay();
  });

  // è¼‰å…¥å€/è·¯ï¼šè¶…å•†
  const cvsCounty = el('cp-cvs-county');
  const cvsDistrict = el('cp-cvs-district');
  const cvsRoadSel = el('cp-cvs-road');
  const cvsRoadInput = el('cp-cvs-road-input');

  cvsCounty?.addEventListener('change', async () => {
    console.log('è¶…å•†ç¸£å¸‚è®Šæ›´:', cvsCounty.value);
    const c = cvsCounty.value;
    
    if (!c) {
      fillSelect(cvsDistrict, [], 'è«‹å…ˆé¸ç¸£å¸‚');
      if (cvsRoadSel) fillSelect(cvsRoadSel, [], 'è«‹å…ˆé¸å€');
      return;
    }
    
    // ç¢ºä¿è³‡æ–™å·²è¼‰å…¥
    const data = await loadAddressData();
    console.log('è³‡æ–™è¼‰å…¥ç‹€æ…‹:', data ? `${data.length}ç­†` : 'ç„¡è³‡æ–™');
    
    if (data && data.length > 0) {
      const districts = getDistricts(data, c);
      console.log(`${c} çš„å€åŸŸ:`, districts);
      fillSelect(cvsDistrict, districts, 'è«‹é¸æ“‡å€');
      if (cvsRoadSel) fillSelect(cvsRoadSel, [], 'è«‹å…ˆé¸å€');
          } else {
        fillSelect(cvsDistrict, [], 'ç„¡æ³•è¼‰å…¥å€');
        showError('ç„¡æ³•è¼‰å…¥å€åŸŸè³‡æ–™');
      }
      updateZipCvsDisplay();
    });

  cvsDistrict?.addEventListener('change', async () => {
    console.log('è¶…å•†å€åŸŸè®Šæ›´:', cvsDistrict.value);
    const c = cvsCounty.value;
    const d = cvsDistrict.value;
    
    if (!c || !d) return;
    
    if (cvsRoadSel) {
      const data = await loadAddressData();
      
      if (data && data.length > 0) {
        const roads = getRoads(data, c, d);
        console.log(`${c} ${d} çš„è·¯å:`, roads);
        fillSelect(cvsRoadSel, roads, 'è«‹é¸æ“‡è·¯å');
              } else {
          fillSelect(cvsRoadSel, [], 'ç„¡æ³•è¼‰å…¥è·¯å');
          showError('ç„¡æ³•è¼‰å…¥è·¯åè³‡æ–™');
        }
      }
      updateZipCvsDisplay();
    });

  // â˜… æ–°å¢ï¼šå°/è‡ºèˆ‡ç©ºç™½æ­£è¦åŒ–
  function normalizeTW(str) {
    if (!str) return '';
    return String(str).replace(/å°/g, 'è‡º').replace(/\s+/g, '');
  }
  function canonicalCounty(v){ return normalizeTW(v); }
  function canonicalDistrict(v){ return normalizeTW(v); }

  // â˜… æ–°å¢ï¼šéƒµéå€è™Ÿæç¤ºå…±ç”¨å‡½å¼
  function setZipHint(idWrap, idText, zip){
    const wrap = document.getElementById(idWrap);
    const txt  = document.getElementById(idText);
    if (!wrap || !txt) return;
    txt.textContent = zip || 'â€”';
    wrap.setAttribute('data-empty', zip ? 'false' : 'true');
  }

  // å·¥å…·ï¼šå§“åæ‹†åˆ†ï¼ˆä¸­æ–‡å„ªå…ˆï¼Œä½†å›å‚³ first=å, last=å§“ï¼‰
  function splitName(full) {
    if (!full) return { first: '', last: '' };
    const raw = full.trim();
    // è‹±æ–‡ï¼šæœ€å¾Œä¸€å€‹ token è¦–ç‚ºå§“ï¼Œå…¶é¤˜æ˜¯å
    if (/[A-Za-z]/.test(raw)) {
      const parts = raw.split(/\s+/);
      if (parts.length === 1) return { first: parts[0], last: '' };
      return { first: parts.slice(0, -1).join(' '), last: parts.slice(-1)[0] };
    }
    // ä¸­æ–‡ï¼šç¬¬ä¸€å­—ç‚ºå§“ï¼Œå…¶é¤˜ç‚ºåï¼ˆç‹å°æ˜ => å§“=ç‹, å=å°æ˜ï¼‰
    const name = raw.replace(/\s+/g, '');
    if (name.length <= 1) return { first: name, last: '' };
    return { first: name.slice(1), last: name[0] };
  }

  function normPhone(v) {
    return (v || '').replace(/[^\d+]/g, '');
  }

  async function saveCartAttributes(obj) {
    if (!s.enable_attr) return;
    try {
      await fetch('/cart/update.js', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ attributes: obj })
      });
    } catch (e) {
      console.warn('cart attributes failed', e);
    }
  }

  // è¨Šæ¯é¡¯ç¤ºåŠŸèƒ½
  function showLoading(text) {
    if (msg) {
      msg.innerHTML = `<span class="apgo-loading"></span> ${text}`;
      msg.className = 'apgo-message';
    }
  }

  function showError(text) {
    if (msg) {
      msg.textContent = text;
      msg.className = 'apgo-message error';
    }
  }

  function showSuccess(text) {
    if (msg) {
      msg.textContent = text;
      msg.className = 'apgo-message success';
    }
  }

  function hideMessage() {
    if (msg) {
      msg.textContent = '';
      msg.className = 'apgo-message';
    }
  }


})();
</script>

{% schema %}
{
  "name": "APGO çµå¸³é å¡«ï½œå®…é…/è¶…å•†",
  "enabled_on": { "templates": ["cart"] },
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "æ¨™é¡Œ",
      "default": "å¡«å¯«æ”¶ä»¶è³‡æ–™"
    },
    {
      "type": "textarea",
      "id": "subtitle",
      "label": "èªªæ˜",
      "default": "é¸æ“‡é‹é€æ–¹å¼ä¸¦å¡«å¯«è³‡æ–™ï¼Œä¸‹ä¸€æ­¥è‡ªå‹•å¸¶å…¥çµå¸³é "
    },
    {
      "type": "checkbox",
      "id": "enable_home",
      "label": "å•Ÿç”¨ã€å®…é…ã€è¡¨å–®",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "enable_cvs",
      "label": "å•Ÿç”¨ã€è¶…å•†ã€è¡¨å–®",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "enable_zip",
      "label": "é¡¯ç¤ºéƒµéå€è™Ÿæ¬„ä½ï¼ˆå®…é…ï¼‰",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "enable_attr",
      "label": "å¯«å…¥ cart attributes",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "enable_road_dropdown",
      "label": "è¶…å•†ï¼šå•Ÿç”¨è·¯åä¸‹æ‹‰é¸å–®",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "enable_detail_address",
      "label": "è¶…å•†ï¼šé¡¯ç¤ºè©³ç´°åœ°å€æ¬„ä½",
      "default": true
    },

    {
      "type": "text",
      "id": "country",
      "label": "Countryï¼ˆçµå¸³é å¡«ï¼‰",
      "default": "Taiwan"
    }
  ],
  "presets": [
    {
      "name": "APGO çµå¸³é å¡«ï½œå®…é…/è¶…å•†"
    }
  ]
}
{% endschema %}